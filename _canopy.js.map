{"version":3,"file":"canopy.js","mappings":"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","sources":["webpack:///./cli/shared/remove_style_characters.js","webpack:///./cli/shared/topic.js","webpack:///./client/style/canopy.scss","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack:///./node_modules/css.escape/css.escape.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack:///./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack:///./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack:///./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack:///./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/global","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/nonce","webpack:///./client/style/canopy.scss?ec98","webpack:///./client/helpers/getters.js","webpack:///./client/requests/request_cache.js","webpack:///./client/models/link.js","webpack:///./client/models/paragraph.js","webpack:///./client/models/path.js","webpack:///./client/requests/request_json.js","webpack:///./client/requests/helpers.js","webpack:///./client/render/click_handlers.js","webpack:///./client/display/display_path.js","webpack:///./client/display/helpers.js","webpack:///./client/render/render_token_element.js","webpack:///./client/assets/external_link_icon/icon.svg","webpack:///./client/render/render_dom_tree.js","webpack:///./client/render/fetch_and_render_path.js","webpack:///./client/render/helpers.js","webpack:///./client/display/update_view.js","webpack:///./client/keys/key_handlers.js","webpack:///./client/keys/arrow_keys.js","webpack:///./client/keys/register_key_listeners.js","webpack:///./client/history/register_pop_state_listener.js","webpack:///./client/canopy.js"],"sourcesContent":["/*\nThis function removes style characters from a string, eg '*_a_* -> 'a'\nIn order to remove multiple layers of wrapping, eg *_a_*, each call removes the outermost layer,\n  then, if there was a difference between the previous value and this one, we try once more.\n  If there was no difference, then we have run out of style tokens and can return.\n*/\n\nfunction removeStyleCharacters(string) {\n  let newString = string.replace(/(.*?(?:^|[^\\\\]))([_`*~])(\\S*?[^\\\\])\\2(.*)/, '$1$3$4'); // style characters within words if no spaces\n  newString = newString.replace(/(.*?(?:^|[^\\\\]))([_`*~])(.*?[^\\\\])\\2(?![A-Za-z0-9])(.*)/, '$1$3$4'); // style characters at edges regardless of content\n  if (newString !== string) {\n    return removeStyleCharacters(newString);\n  } else {\n    return string;\n  }\n}\n\nmodule.exports = removeStyleCharacters;\n","let removeStyleCharacters = require('./remove_style_characters');\nrequire('css.escape');\n\nclass Topic {\n  // There are several permutations of the topic key\n\n  constructor(string) {\n    this.display = string; // the string precisely as it appears in the expl file\n\n    this.mixedCase = removeStyleCharacters(string)  // the display verison sans style characters * _ ~ ` and a trailing question mark, encoding style characters\n      .split(/\\\\\\\\/g).map(string => string.replace(/\\\\/g, '')).join('\\\\\\\\'); // Remove backslashes that are escaping literal characters now that removeStyleCharacters has already run\n\n    this.escapedMixedCase = CSS.escape(this.mixedCase);\n\n    this.slug = this.mixedCase // This string encodes characters that will cause problems in the URL, but we do not encode all characters eg quotation marks. Must be reversable.\n      .replace(/%/g, '%25') // This way you can't have collisions if the user names something with a % which we're using for encodings\n      .replace(/\\\\\\\\/g, '%5C%5C') // a double backslash represents a literal backslash not an escape character\n      .replace(/`/g, '%60') // Chrome automatically replaces in URL and could be misinterpreted on the command line as subshell\n      .replace(/_/g, '%5C_') // Literal style characters are escaped so that when we parse the URL, we don't remove them with removeStyleCharacters\n      .replace(/ /g, '_') // This must be done after literal underscores have received encoded backslashes above to distinguish between them and these\n      .replace(/\\//g, '%2F')\n      .replace(/([.,])(?=[\"'')}\\]]+$)/g, ''); // Allow links to contain terminal periods or commas eg he went to [[\"Spain.\"]]\n\n    this.url = this.slug\n      .replace(/#/g, '%23')\n\n    this.fileName = this.slug // This string encodes characters that will cause problems in the URL, but we do not encode all characters eg quotation marks. Must be reversable.\n      .replace(/\"/g, '%22')\n      .replace(/'/g, '%27')\n      .replace(/,/g, '%2C')\n      .replace(/:/g, '%3A')\n      .replace(/</g, '%3C')\n      .replace(/>/g, '%3E')\n      .replace(/\\|/g, '%7C')\n      .replace(/\\*/g, '%2A')\n      .replace(/\\?/g, '%3F');\n\n    this.caps = this.mixedCase // This is the string that is used to find matches between links and topic names.\n      .toUpperCase() // We want matches to be case-insensitive\n      .replace(/\\?$/, '') // It should match whether or not both have trailing question marks\n      .replace(/[\"']/g, '') // We remove quotation marks so matches ignore them\n      .replace(/\\(/g, '') // we remove parentheses to allow link texts to contain optional parentheses\n      .replace(/\\)/g, '')\n      .replace(/ +/g, ' ') // consolidate spaces\n      .replace(/&NBSP;/g, ' ')\n      .trim() // remove initial and leading space, eg when using interpolation syntax: [[{|display only} actual topic name]]\n\n    this.requestFileName = encodeURIComponent(this.fileName); // This is the string that will be used to _request_ the file name on disk, so it needs to be encoded\n  }\n\n  static fromMixedCase(string) {\n    string = string.replace(/([`_~*])/g, '\\\\$1'); // In mixed case style character literals are unescaped, so we escape them to avoid double-processing\n    let topic = new Topic(string);\n    topic.display = null; // If a topic instance was instantiated from the mixed-case string, the display version is irretrievable\n    return topic;\n  }\n\n  static fromEncodedSlug(string) {\n    string = convertUnderscoresToSpaces(string);\n    string = decodeURIComponent(string);\n    string = string\n      .replace(/\\*/g, '\\\\*') // underscores are escaped in the URL itself, but for the other style characters we must escape them so that\n      .replace(/`/g, '\\\\`')  // they don't get stripped by removeStyleCharacters\n      .replace(/~/g, '\\\\~');\n\n    let topic = new Topic(string); // Encoded style characters decode to escaped style characters, so we can use the regular\n                                   // \"display -> mixed case\" processing step, even though this isn't the display string\n    topic.display = null; // The encoded slug was formed from the lossy mixed case version, so that is the best we can reconstruct from it\n    return topic;\n  }\n}\n\nTopic.convertUnderscoresToSpaces = function convertUnderscoresToSpaces(string) {\n  // We want to turn underscores into spaces, but not escaped underscores ie %5C_, but yes escaped escaped underscores ie %5C%5C_\n  return string.split(/%5C%5C/g) // first remove double backslashes to avoid seeing %5C%5C_ as an underscore literal instead of backslash literal followed by a space\n    .map(string => string\n      .split(/%5C_/g) // now remove escaped backslashes to avoid seeing them as spaces converted to underscores\n      .map(string => string.replace(/_/g, ' '))\n      .join('%5C_') //convert underscores not preceded by single %5C to spaces\n    ).join('%5C%5C');\n}\n\nTopic.convertSpacesToUnderscores = function convertSpacesToUnderscores(string) {\n  return string.split('/').map(string => Topic.for(string).fileName).join('/');\n}\n\nTopic.for = function topicFor(string) {\n  return new Topic(string);\n}\n\nfunction convertUnderscoresToSpaces(string) {\n  // We want to turn underscores into spaces, but not escaped underscores ie %5C_, but yes escaped escaped underscores ie %5C%5C_\n  return string.split(/%5C%5C/g) // first remove double backslashes to avoid seeing %5C%5C_ as an underscore literal\n    .map(string => string\n      .split(/%5C_/g) // now remove escaped backslashes to avoid seeing them as spaces converted to underscores\n      .map(string => string.replace(/_/g, ' '))\n      .join('%5C_') //convert underscores not preceded by single %5C to spaces\n    ).join('%5C%5C');\n}\n\nmodule.exports = Topic;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#_canopy{margin-top:20px;overflow-anchor:none;padding-bottom:80vh;font-family:\\\"Times New Roman\\\",Times,serif}#_canopy h1{text-align:center;margin:auto;margin-top:10px}#_canopy hr{width:120px;display:block;height:1px;border:0;border-top:5px solid #ccc;margin:0px auto}#_canopy h1+section.canopy-topic-section{margin-top:20px}#_canopy section.canopy-topic-section{margin-top:25px}#_canopy section{margin-top:25px}#_canopy p{overflow:visible;font-size:21px;max-width:750px;margin:auto;line-height:1.3;letter-spacing:-0.003em;font-weight:400;position:relative}#_canopy .canopy-topic-section hr+p{margin-top:24px}#_canopy a.canopy-selectable-link{text-decoration:underline #ddd;color:#000;cursor:pointer}#_canopy a.canopy-selectable-link:focus{outline:0}#_canopy a.canopy-selectable-link.canopy-open-link{text-decoration:underline;background-color:#f3f3f3}#_canopy a.canopy-selectable-link:hover{text-decoration:underline #000}#_canopy a.canopy-selectable-link.canopy-selected-link{background-color:#edeefc;text-shadow:0px 0px 0px #000;text-decoration:none}#_canopy a.canopy-selectable-link.canopy-url-link{text-decoration:none;display:inline;overflow-wrap:break-word;white-space:normal;margin-right:-2px}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-tokens-container{text-decoration:underline #ddd}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-tokens-container:hover{text-decoration:underline #000}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-svg-container{padding-right:3px;margin-left:-8px;margin-right:-8px}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-tokens-spacing{font-size:18px}#_canopy a.canopy-selectable-link.canopy-url-link span{display:inline}#_canopy a.canopy-selectable-link.canopy-url-link svg{height:15px;width:12px;vertical-align:-4px}#_canopy span.canopy-text-span{display:block}#_canopy hr.canopy-footnote-rule{width:750px;display:block;height:1px;border:0;border-top:1px solid #ccc;margin:12px 0;padding:0}#_canopy sup{font-size:60%;padding:2px}#_canopy .canopy-footnote-span{font-size:80%;display:block}#_canopy .canopy-footnote-span span{margin-left:2px}#_canopy .canopy-footnote-span:not(:last-child){padding-bottom:7px}#_canopy blockquote{padding:0 .7em;color:#565e67;margin-block-start:.5em;margin-block-end:.5em;margin-inline-start:0px;margin-inline-end:0px}#_canopy blockquote a,#_canopy blockquote a.canopy-selectable-link{color:#565e67}#_canopy blockquote[dir=rtl]{border-right:.25em solid #d3d3d3}#_canopy blockquote[dir=ltr]{border-left:.25em solid #d3d3d3}#_canopy blockquote a.canopy-selectable-link{text-decoration:underline #d3d3d3}#_canopy pre{margin:10px 10px;background-color:#eff0f1;padding:5px;font-size:85%}#_canopy code{background-color:#eff0f1;font-size:90%}#_canopy table{margin:21px auto auto auto;table-layout:auto;max-width:90%;border-collapse:collapse;border:none;font-size:18px;min-width:500px;table-layout:fixed}#_canopy table:not(:last-child){margin-bottom:21px}#_canopy table td,#_canopy table th{border:1px solid #000;text-align:center;padding:10px}#_canopy table td.hidden,#_canopy table th.hidden{display:none}#_canopy table td br,#_canopy table th br{display:block;content:\\\"\\\";padding-bottom:2px}#_canopy table td.canopy-table-link-cell{cursor:pointer}#_canopy table td.canopy-table-link-cell a.canopy-selectable-link{text-decoration:none;text-shadow:none}#_canopy table td.canopy-table-link-cell:has(.canopy-selected-link){background-color:#edeefc}#_canopy table td.canopy-table-link-cell:has(.canopy-open-link):not(:has(.canopy-selected-link)){background-color:#f3f3f3}#_canopy table td.canopy-table-link-cell:hover:not(:has(.canopy-selected-link)),#_canopy table td.canopy-table-link-cell:hover:has(.canopy-open-link):not(:has(.canopy-selected-link)){background-color:#f5f6fe}#_canopy table td.canopy-table-link-cell:hover:not(:has(.canopy-selected-link)) .canopy-selected-link,#_canopy table td.canopy-table-link-cell:hover:has(.canopy-open-link):not(:has(.canopy-selected-link)) .canopy-selected-link{background-color:#f5f6fe}#_canopy .canopy-table-list-container{display:flex;flex-direction:column;max-width:96vw;width:96vw;margin-left:calc(-48vw + 375px);text-wrap:balance}#_canopy .canopy-table-list-container.canopy-quarter-pill .canopy-table-list-cell{width:175px;padding:9px;max-height:50px}#_canopy .canopy-table-list-container.canopy-third-pill .canopy-table-list-cell{width:220px;padding:9px;max-height:50px}#_canopy .canopy-table-list-container.canopy-half-pill .canopy-table-list-cell{width:270px;padding:9px;max-height:50px}#_canopy .canopy-table-list-container.canopy-quarter-card .canopy-table-list-cell{width:175px;height:95px;padding:15px}#_canopy .canopy-table-list-container.canopy-third-card .canopy-table-list-cell{width:215px;height:120px;padding:15px}#_canopy .canopy-table-list-container.canopy-half-card .canopy-table-list-cell{width:285px;min-height:160px;padding:30px}#_canopy .canopy-table-list-container:not(:first-child){margin-top:15px}#_canopy .canopy-table-list-container:not(:last-child){margin-bottom:15px}#_canopy .canopy-table-list-container .canopy-table-list{display:flex;flex-direction:column;margin:0 auto}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-row{display:flex}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-cell{display:flex;margin:5px;border:1px solid #000;border-radius:0px;text-align:center;justify-content:center;align-items:center;box-sizing:border-box;background-color:#fff}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-cell br{display:block;content:\\\"\\\";padding-bottom:2px}@media screen and (max-width: 1000px){#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-cell{max-width:10vw}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-content-container *{max-width:6vw}}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell{cursor:pointer;border:1.5px solid #000;border-radius:5px}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell.canopy-url-link *,#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell.canopy-url-link *:hover{text-decoration:none}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell.canopy-selectable-link{text-decoration:none;text-shadow:none}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell.canopy-selected-link{background-color:#edeefc}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell.canopy-open-link:not(.canopy-selected-link){background-color:#f3f3f3}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell:hover:not(.canopy-selected-link),#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell:hover.canopy-open-link:not(.canopy-selected-link){background-color:#f5f6fe}#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell:hover:not(.canopy-selected-link) .canopy-selected-link,#_canopy .canopy-table-list-container .canopy-table-list .canopy-table-list-link-cell:hover.canopy-open-link:not(.canopy-selected-link) .canopy-selected-link{background-color:#f5f6fe}#_canopy .canopy-image{margin-top:15px}#_canopy .canopy-image:not(:last-child){margin-bottom:15px}#_canopy .canopy-image a{margin:0 auto;display:block;background-color:F1F1F1}#_canopy .canopy-image img{display:block;width:100%;margin:0 auto}#_canopy .canopy-image span.canopy-image-caption{margin:0px auto;width:100%;padding:6px 0;text-align:left;display:block;font-size:16px;margin-top:4px;line-height:18px;color:#595959}#_canopy .canopy-image span.canopy-image-caption a{color:#595959}#_canopy .canopy-image span.canopy-image-caption span{display:inline}#_canopy div.canopy-image-div{float:right;border:1px solid #c8ccd1;padding:3px;background-color:#f8f9fa;font-size:94%;text-align:center;overflow:hidden;margin:10px}#_canopy div.canopy-image-div>sup{display:block}#_canopy ol,#_canopy ul{margin-top:15px;margin-left:10px;margin-right:10px;margin-bottom:0px}#_canopy ol:not(:last-child),#_canopy ul:not(:last-child){margin-bottom:15px}#_canopy ol li:not(:last-child),#_canopy ul li:not(:last-child){margin-bottom:10px}#_canopy div.canopy-raw-html{display:inline}\", \"\",{\"version\":3,\"sources\":[\"webpack://./client/style/canopy.scss\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\"#_canopy {\\n  margin-top: 20px;\\n  overflow-anchor: none; // Prevent browser from trying to maintain position when page contents change, which might interfere with window.scrollTo\\n\\n  /* Removing DOM elements from the bottom of the screen can force the page to scroll upward to the existing elements\\n  which is not animated. If we keep a padding on the bottom of the last element just beyond the viewport, then\\n  removal of elements from the bottom of the visible stack never brings the real bottom of the page into view, and so\\n  the scroll upwards can be animated using the window.scrollTo method. */\\n\\n  padding-bottom: calc(80vh);\\n\\n  font-family: \\\"Times New Roman\\\", Times, serif;\\n\\n  h1 {\\n    text-align: center;\\n    margin: auto;\\n    margin-top: 10px;\\n  }\\n\\n  hr {\\n    width: 120px;\\n    display: block;\\n    height: 1px;\\n    border: 0;\\n    border-top: 5px solid #ccc;\\n    margin: 0px auto;\\n  }\\n\\n  h1 + section.canopy-topic-section {\\n    margin-top: 20px;\\n  }\\n\\n  section.canopy-topic-section {\\n    margin-top: 25px;\\n  }\\n\\n  section {\\n    margin-top: 25px;\\n  }\\n\\n  p {\\n    overflow: visible; // In case external link icon is at end of line\\n    font-size: 21px;\\n    max-width: 750px;\\n    margin: auto;\\n\\n    line-height: 1.3;\\n    letter-spacing: -.003em;\\n    font-weight: 400;\\n\\n    position: relative; // to allow absolute children\\n  }\\n\\n  .canopy-topic-section hr + p {\\n    margin-top: 24px; // 25px minus 1px bar thickness\\n  }\\n\\n///////////// Link styles /////////////////\\n\\n  a.canopy-selectable-link {\\n    text-decoration: underline #DDDDDD;\\n    color: black;\\n    cursor: pointer;\\n\\n    &:focus {\\n      outline:0;\\n    }\\n\\n    &.canopy-open-link {\\n      // text-shadow: .8px 0px 0px #000000;\\n      text-decoration: underline;\\n      background-color: #F3F3F3;\\n    }\\n\\n    &:hover {\\n      text-decoration: underline #000000;\\n    }\\n\\n    &.canopy-selected-link {\\n      background-color: #edeefc;\\n      text-shadow: 0px 0px 0px #000000;\\n      text-decoration: none;\\n    }\\n\\n    &.canopy-url-link {\\n      text-decoration: none; // we want the selection background to extend beyond the icon but the underlining only until the end of the icon's bottom\\n      display: inline;\\n      overflow-wrap: break-word;\\n      white-space: normal;\\n      margin-right: -2px; // we want the text after the icon to hug the icon, eg if it is a period\\n\\n      .canopy-url-link-tokens-container {\\n        text-decoration: underline #DDDDDD;\\n\\n        &:hover {\\n          text-decoration: underline #000000; // hover underline should be black\\n        }\\n      }\\n\\n      .canopy-url-link-svg-container {\\n        padding-right: 3px; // this is the spacing after the icon that extends the selected-link-selection bg but not the underlining\\n        margin-left: -8px; // We add 3 non-breaking spaces, then move the svg over them so the last word always wraps with svg\\n        margin-right: -8px; // If character after is punctuation and we move it within the spacing, it will also wrap with the svg\\n      }\\n\\n      .canopy-url-link-tokens-spacing { // this is the spacing before the icon that creates space for the icon's negative margin\\n        font-size: 18px;                // we use spaces and not padding because spaces can get text-decoration\\n      }\\n\\n      span {\\n        display: inline;\\n      }\\n\\n      svg {\\n        height: 15px;\\n        width: 12px;\\n        vertical-align: -4px; // move the icon in-line with the text\\n      }\\n     }\\n  }\\n\\n/////////////////////////////////////////////\\n\\n  span.canopy-text-span {\\n    display: block;\\n  }\\n\\n  hr.canopy-footnote-rule {\\n    width: 750px;\\n    display: block;\\n    height: 1px;\\n    border: 0;\\n    border-top: 1px solid #ccc;\\n    margin: 12px 0;\\n    padding: 0;\\n  }\\n\\n  sup {\\n    font-size: 60%;\\n    padding: 2px;\\n  }\\n\\n  .canopy-footnote-span {\\n    font-size: 80%;\\n    display: block;\\n    span { // text after number\\n      margin-left: 2px;\\n    }\\n    &:not(:last-child) {\\n      padding-bottom: 7px;\\n    }\\n  }\\n\\n  blockquote {\\n    padding: 0 .7em;\\n    color: #565e67;\\n\\n    a, a.canopy-selectable-link {\\n      color: #565e67;\\n    }\\n\\n    &[dir=\\\"rtl\\\"] {\\n      border-right: 0.25em solid lightgray;\\n    }\\n\\n    &[dir=\\\"ltr\\\"] {\\n      border-left: 0.25em solid lightgray;\\n    }\\n\\n    margin-block-start: .5em;\\n    margin-block-end: .5em;\\n    margin-inline-start: 0px;\\n    margin-inline-end: 0px;\\n\\n    a.canopy-selectable-link {\\n      text-decoration: underline #D3D3D3;\\n    }\\n  }\\n\\n  pre {\\n    margin: 10px 10px;\\n    background-color: #eff0f1;\\n    padding: 5px;\\n    font-size: 85%;\\n  }\\n\\n  code {\\n    background-color: #eff0f1;\\n    font-size: 90%;\\n  }\\n\\n  table {\\n    margin: 21px auto auto auto;\\n    table-layout: auto;\\n    max-width: 90%;\\n    border-collapse: collapse;\\n    border: none; // we put the border on the TDs to allow omitted table cells\\n    font-size: 18px;\\n    min-width: 500px;\\n    table-layout: fixed;\\n\\n    &:not(:last-child) {\\n      margin-bottom: 21px;\\n    }\\n\\n    td, th {\\n      border: 1px solid black;\\n      text-align: center;\\n      padding: 10px;\\n\\n      // width: 0%; // this seems to make cells even without expanding table\\n\\n      &.hidden {\\n        display: none;\\n      }\\n\\n      br {\\n        display: block; // makes it have a width\\n        content: \\\"\\\"; // clears default height\\n        padding-bottom: 2px;\\n      }\\n    }\\n\\n    td.canopy-table-link-cell {\\n      cursor: pointer;\\n\\n      a.canopy-selectable-link {\\n        text-decoration: none;\\n        text-shadow: none;\\n      }\\n\\n      &:has(.canopy-selected-link) {\\n        background-color: #edeefc;\\n      }\\n\\n      &:has(.canopy-open-link):not(:has(.canopy-selected-link)) {\\n        background-color: #F3F3F3;\\n      }\\n\\n      &:hover:not(:has(.canopy-selected-link)), // selected link style overrides hover\\n      &:hover:has(.canopy-open-link):not(:has(.canopy-selected-link)) {\\n        background-color: #f5f6fe;\\n\\n        .canopy-selected-link {\\n            background-color: #f5f6fe;\\n        }\\n      }\\n    }\\n  }\\n\\n  .canopy-table-list-container {\\n    display: flex;\\n    flex-direction: column;\\n    max-width: 96vw;\\n    width: 96vw;\\n    margin-left: calc((-96vw / 2) + (750px / 2));\\n    text-wrap: balance;\\n\\n    &.canopy-quarter-pill .canopy-table-list-cell {\\n      width: 175px;\\n      padding: 9px;\\n      max-height: 50px;\\n    }\\n\\n    &.canopy-third-pill .canopy-table-list-cell {\\n      width: 220px;\\n      padding: 9px;\\n      max-height: 50px;\\n    }\\n\\n    &.canopy-half-pill .canopy-table-list-cell {\\n      width: 270px;\\n      padding: 9px;\\n      max-height: 50px;\\n    }\\n\\n    &.canopy-quarter-card .canopy-table-list-cell {\\n      width: 175px;\\n      height: 95px;\\n      padding: 15px;\\n    }\\n\\n    &.canopy-third-card .canopy-table-list-cell {\\n      width: 215px;\\n      height: 120px;\\n      padding: 15px;\\n    }\\n\\n    &.canopy-half-card .canopy-table-list-cell {\\n      width: 285px;\\n      min-height: 160px;\\n      padding: 30px;\\n    }\\n\\n    &:not(:first-child) {\\n      margin-top: 15px;\\n    }\\n\\n    &:not(:last-child) {\\n      margin-bottom: 15px;\\n    }\\n\\n    .canopy-table-list {\\n      display: flex;\\n      flex-direction: column;\\n      margin: 0 auto;\\n\\n      .canopy-table-list-row {\\n        display: flex;\\n      }\\n\\n      .canopy-table-list-cell {\\n        display: flex;\\n        margin: 5px;\\n        border: 1px solid black;\\n        border-radius: 0px;\\n        text-align: center;\\n        justify-content: center;\\n        align-items: center;\\n        box-sizing: border-box;\\n        background-color: white;\\n\\n        br {\\n          display: block; // makes it have a width\\n          content: \\\"\\\"; // clears default height\\n          padding-bottom: 2px;\\n        }\\n\\n        .canopy-table-list-ordinal {\\n        }\\n\\n        .canopy-table-list-content-container {\\n          &.canopy-align-left {\\n            //text-align: left;\\n          }\\n        }\\n      }\\n\\n      @media screen and (max-width: 1000px) {\\n        .canopy-table-list-cell {\\n          max-width: 10vw;\\n        }\\n\\n        .canopy-table-list-content-container * {\\n          max-width: 6vw;\\n        }\\n      }\\n\\n      .canopy-table-list-content-container {\\n        //overflow: scroll;\\n      }\\n\\n      .canopy-table-list-link-cell {\\n        cursor: pointer;\\n        border: 1.5px solid black;\\n        border-radius: 5px;\\n\\n        &.canopy-url-link *, &.canopy-url-link *:hover {\\n          text-decoration: none;\\n        }\\n\\n        &.canopy-selectable-link {\\n          text-decoration: none;\\n          text-shadow: none;\\n        }\\n\\n        &.canopy-selected-link {\\n          background-color: #edeefc;\\n        }\\n\\n        &.canopy-open-link:not(.canopy-selected-link) {\\n          background-color: #F3F3F3;\\n        }\\n\\n        &:hover:not(.canopy-selected-link), // selected link style overrides hover\\n        &:hover.canopy-open-link:not(.canopy-selected-link) {\\n          background-color: #f5f6fe;\\n\\n          .canopy-selected-link {\\n              background-color: #f5f6fe;\\n          }\\n        }\\n      }\\n    }\\n  }\\n\\n  .canopy-image {\\n    &:not(:last-child) {\\n      margin-bottom: 15px;\\n    }\\n\\n    margin-top: 15px;\\n\\n    a {\\n      margin: 0 auto;\\n      display: block;\\n      background-color: F1F1F1;\\n    }\\n\\n    img {\\n      display: block;\\n      width: 100%;\\n      margin: 0 auto;\\n    }\\n\\n    span.canopy-image-caption {\\n      margin: 0px auto;\\n      width: 100%;\\n      padding: 6px 0;\\n      text-align: left;\\n      display: block;\\n      font-size: 16px;\\n      margin-top: 4px;\\n      line-height: 18px;\\n      color: #595959;\\n\\n      a {\\n        color: #595959;\\n      }\\n\\n      span {\\n        display: inline;\\n      }\\n    }\\n  }\\n\\n  div.canopy-image-div {\\n    float: right;\\n    border: 1px solid #c8ccd1;\\n    padding: 3px;\\n    background-color: #f8f9fa;\\n    font-size: 94%;\\n    text-align: center;\\n    overflow: hidden;\\n    margin: 10px;\\n  }\\n\\n  div.canopy-image-div > sup {\\n    display: block;\\n  }\\n\\n  ol, ul {\\n    margin-top: 15px;\\n    margin-left: 10px;\\n    margin-right: 10px;\\n    margin-bottom: 0px;\\n\\n    &:not(:last-child) {\\n      margin-bottom: 15px;\\n    }\\n\\n    li:not(:last-child) {\\n      margin-bottom: 10px;\\n    }\\n  }\\n\\n  div.canopy-raw-html {\\n    display: inline;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: theres no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, []\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), []\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), []\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, []\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), []\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n","\"use strict\";\n\nvar stylesInDOM = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n\n  return updater;\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n/* istanbul ignore next  */\n\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n\n    memo[target] = styleTarget;\n  }\n\n  return memo[target];\n}\n/* istanbul ignore next  */\n\n\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n\n  target.appendChild(style);\n}\n\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\n\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\n\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n\n  var needLayer = typeof obj.layer !== \"undefined\";\n\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n\n  css += obj.css;\n\n  if (needLayer) {\n    css += \"}\";\n  }\n\n  if (obj.media) {\n    css += \"}\";\n  }\n\n  if (obj.supports) {\n    css += \"}\";\n  }\n\n  var sourceMap = obj.sourceMap;\n\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  options.styleTagTransform(css, styleElement, options.options);\n}\n\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n\n  styleElement.parentNode.removeChild(styleElement);\n}\n/* istanbul ignore next  */\n\n\nfunction domAPI(options) {\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\n\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\n\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nc = undefined;","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./canopy.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./canopy.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import json from '../../package.json';\n\nconst canopyContainer = document.getElementById('_canopy');\n\ncanopyContainer.dataset.canopyVersion = json.version;\n\nconst defaultTopic = canopyContainer && canopyContainer.dataset.defaultTopic;\n\nconst projectPathPrefix = canopyContainer && canopyContainer.dataset.projectPathPrefix;\n\nconst hashUrls = canopyContainer && canopyContainer.dataset.hashUrls;\n\nfunction getAncestorElement(currentElement, className) {\n  let parentElement = currentElement.parentElement;\n  while (parentElement.classList && !parentElement.classList.contains(className)) {\n    if (parentElement === canopyContainer) return null;\n    parentElement = parentElement.parentNode;\n  }\n  return parentElement;\n}\n\nexport {\n  canopyContainer,\n  defaultTopic,\n  projectPathPrefix,\n  hashUrls,\n  getAncestorElement\n};\n","let REQUEST_CACHE = {};\n\nexport default REQUEST_CACHE;\n","import { getAncestorElement } from 'helpers/getters';\nimport Path from 'models/path';\nimport Paragraph from 'models/paragraph';\nimport Topic from '../../cli/shared/topic';\n\nclass Link {\n  constructor(argument) {\n    // There are three ways to instantiate a link object:\n    // 1. You can provide a DOM element\n    // 2. You can provide a metadata object\n    //   (This is helpful when storing link selection in the session or history)\n    // 3. You can provide a callback that returns the link\n    //   (This is helpful for selecting links that are not yet rendered)\n\n    if (argument?.tagName === 'A') {\n      this.element = argument;\n    } else if (argument instanceof Link) {\n      throw new Error(\"Cannot instantiate link from link\");\n    } else if (typeof argument === 'object') {\n      this.metadataObject = argument;\n    } else if (typeof argument === 'function') {\n      this.selectorCallback = argument;\n    } else {\n      throw new Error('Invalid argument to Link constructor');\n    }\n  }\n\n  equals(otherLink) {\n    return this.element === otherLink.element;\n  }\n\n  matches(otherLink) {\n    if (!otherLink) throw new Error('Invalid link argument to Link#matches');\n\n    return this.targetTopic === otherLink.targetTopic &&\n      this.targetSubtopic === otherLink.targetSubtopic &&\n      this.relativeLinkNumber === otherLink.relativeLinkNumber;\n  }\n\n  contradicts(path) {\n    if (!(path instanceof Path)) throw new Error('Invalid path argument to Link#contradicts');\n    return this.path.string !== path.string;\n  }\n\n  get element () {\n    if (this.linkElement) {\n      return this.linkElement\n    } else if (this.metadataObject) {\n      this.element = Link.elementFromMetadata(this.metadata);\n      if (!this.linkElement) throw new Error('Metadata refered to non-existant link');\n      return this.linkElement;\n    } else if (this.selectorCallback) {\n      let link = this.selectorCallback();\n      if (!link) throw new Error('Link selector callback provided no link');\n      this.element = link.element;\n      return this.linkElement;\n    }\n  }\n\n  set element(argument) {\n    if (argument instanceof HTMLAnchorElement) {\n      this.linkElement = argument;\n    } else if (argument instanceof Link) {\n      this.linkElement = argument.element;\n    }\n    this.transferDataset();\n  }\n\n  transferDataset() {\n    // This is just to make it easier to inspect and debug DOM elements\n    // Getters are used instead of properties to allow lazy access for callback-specified links\n    if (!this.linkElement) return;\n    this._targetTopic = this.linkElement.dataset.targetTopic;\n    this._targetSubtopic = this.linkElement.dataset.targetSubtopic;\n    this._enclosingTopic = this.linkElement.dataset.enclosingTopic;\n    this._enclosingSubtopic = this.linkElement.dataset.enclosingSubtopic;\n    this._typeValue = this.linkElement.dataset.type;\n  }\n\n  get targetTopic() {\n    return Topic.fromMixedCase(this.element.dataset.targetTopic);\n  }\n  get targetSubtopic() {\n    return Topic.fromMixedCase(this.element.dataset.targetSubtopic);\n  }\n  get enclosingTopic() {\n    return Topic.fromMixedCase(this.element.dataset.enclosingTopic);\n  }\n  get enclosingSubtopic() {\n    return Topic.fromMixedCase(this.element.dataset.enclosingSubtopic);\n  }\n\n  get topicName() {\n    throw new Error('Links have no topicName, only targetTopic or enclosingTopic');\n  }\n\n  get subtopicName() {\n    throw new Error('Links have no subtopicName, only targetSubtopic or enclosingSubtopic');\n  }\n\n  get type() {\n    return this.element.dataset.type;\n  }\n\n  get enclosingSectionElement() {\n    return getAncestorElement(this.element, 'canopy-section');\n  }\n\n  get sectionElement() {\n    throw new Error(\"Depreciated in favor of #enclosingSectionElement\");\n  }\n\n  get enclosingParagraphElement() {\n    return getAncestorElement(this.element, 'canopy-paragraph');\n  }\n\n  get parentParagraphElement() {\n    throw new Error(\"Depreciated in favor of #enclosingParagraphElement\");\n  }\n\n  get enclosingParagraph() {\n    return new Paragraph(this.enclosingSectionElement);\n  }\n\n  get targetParagraph() {\n    if (!this.isParent) return null;\n\n    let pathDepth = this.enclosingParagraph.pathDepth;\n    if (this.isGlobalOrImport) pathDepth = Number(pathDepth) + 1;\n\n    let sectionElement = this.enclosingParagraph.sectionElement.querySelector(\n        `section[data-topic-name=\"${this.targetTopic.escapedMixedCase}\"]` +\n        `[data-subtopic-name=\"${this.targetSubtopic.escapedMixedCase}\"]` +\n        `[data-path-depth=\"${pathDepth}\"`\n      );\n\n    if (!sectionElement) {\n      throw new Error(`Did not find paragraph child element matching link [${this.targetTopic.mixedCase}, ${this.targetSubtopic.mixedCase}]`);\n    }\n\n    return new Paragraph(sectionElement);\n  }\n\n  atNewPath(newPath) { // get link instantiated with callback that returns matching link at new path\n    return new Link(() => {\n      let newEnclosingParagraph;\n      if (this.isParent) {\n        newEnclosingParagraph = newPath.paragraph.parentParagraph;\n      } else {\n        newEnclosingParagraph = newPath.paragraph;\n      }\n      return newEnclosingParagraph\n        .links\n        .find(this.matcher);\n    });\n  }\n\n  get localPathSegmentWhenSelected() {\n    if (this.isGlobalOrImport) {\n      return new Path(this.path.pathArray.slice(-2));\n    } else {\n      return this.path.lastSegment;\n    }\n  }\n\n  get matcher() {\n    return (link) => link.matches(this);\n  }\n\n  get relativeLinkNumber() {\n    if (this.storedRelativeLinkNumber) return this.storedRelativeLinkNumber;\n    this.storedRelativeLinkNumber = this.\n      enclosingParagraph.\n      links.\n      map(e => e.element).\n      indexOf(this.element);\n\n    return this.storedRelativeLinkNumber;\n  }\n\n  /* eslint getter-return: \"off\" */\n  get metadata() {\n    if (this.metadataObject) {\n      return this.metadataObject;\n    } else if(this.linkElement) {\n      let metadata = Link.collectMetadata(this.linkElement);\n      this.metadataObject = metadata;\n      return metadata;\n    } else if (this.selectorCallback) {\n      this.element = this.selectorCallback();\n      return this.metadata; // now that there is a this.linkElement\n    } else {\n      throw new Error(\"Link has neither supplied metadata, dom element, nor selector function\");\n    }\n  }\n\n  get targetPath() {\n    if (this.isGlobalOrImport) {\n      return this.enclosingParagraph.path.addSegment(this.targetTopic, this.targetSubtopic);\n    } else if (this.isLocal) {\n      return this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic);\n    } else {\n      return null; // eg URL link\n    }\n  }\n\n  get pathToDisplay() {\n    throw new Error(\"Depreciated in favor of #path\");\n  }\n\n  // Previously there were multiple path concepts related to links, eg the path to the paragraph containing the link,\n  // or the path to the target of the link (if it is local, global, or import), and thirdly the path of paragraphs\n  // to display when the given link is selected. When previously a selected import reference previewed the target\n  // path but used the URL of the enclosing paragraph, these three concepts could vary, but now they always coincide.\n\n  get path() {\n    if (this.isGlobalOrImport) {\n      return this.enclosingParagraph.path.addSegment(this.targetTopic, this.targetSubtopic);\n    } else if (this.isLocal) {\n      return this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic);\n    } else {\n      return this.enclosingParagraph.path;\n    }\n  }\n\n  get urlPathWhenSelected() {\n    throw new Error(\"Depreciated in favor of #path\"); // no longer different from path of displayed paragraph\n  }\n\n  static collectMetadata(linkElement) {\n    let link = new Link(linkElement);\n    let paragraph = Paragraph.containingLink(link);\n\n    // changing the metadata schema requires changing Link#containsLinkSelectionMetadata\n    return {\n      pathString: paragraph.path.string, // initial page load with session/history link selection requires this\n      text: linkElement.dataset.text,\n      relativeLinkNumber: link.relativeLinkNumber\n    };\n  }\n\n  static containsLinkSelectionMetadata(object) {\n    return object.relativeLinkNumber !== undefined;\n  }\n\n  static elementFromMetadata(object) {\n    let path = new Path(object.pathString);\n    let paragraph = path.paragraph;\n    if (!paragraph) throw new Error(\"Link selection data refers to non-existant link\");\n    let link = paragraph.linkBySelector(\n      (link, i) => link.element.dataset.text === object.text &&\n        i === object.relativeLinkNumber\n    );\n\n    return link && link.element || null;\n  }\n\n  get nextSibling() {\n    let links = this.enclosingParagraph.links;\n    if (!this.equals(links[links.length - 1])) {\n      let linkElements = links.map((link) => link.element);\n      let indexOfCurrentLink = linkElements.indexOf(this.element);\n      return links[indexOfCurrentLink + 1];\n    } else {\n      return null;\n    }\n  }\n\n  get previousSibling() {\n    let links = this.enclosingParagraph.links;\n    if (!this.equals(links[0])) {\n      let linkElements = links.map((link) => link.element);\n      let indexOfCurrentLink = linkElements.indexOf(this.element);\n      return links[indexOfCurrentLink - 1];\n    } else {\n      return null;\n    }\n  }\n\n  get siblings() {\n    return this.enclosingParagraph.links;\n  }\n\n  get firstSibling() {\n    return this.siblings[0];\n  }\n\n  get lastSibling() {\n    return this.siblings[this.siblings.length - 1];\n  }\n\n  get firstChildLink() {\n    return this.targetParagraph.firstLink;\n  }\n\n  get lastChildLink() {\n    return this.targetParagraph.lastLink;\n  }\n\n  get parentLink() {\n    return this.enclosingParagraph.parentLink;\n  }\n\n  get grandParentLink() {\n    return this.parentLink?.parentLink;\n  }\n\n  get topicParagraph() {\n    return getAncestorElement(this.element, 'canopy-topic-section');\n  }\n\n  get selected() {\n    return this.element.classList.includes('canopy-selected-link');\n  }\n\n  open() {\n    this.element.classList.add('canopy-open-link');\n  }\n\n  get isOpen() {\n    return this.element.classList.contains('canopy-open-link');\n  }\n\n  get isClosed() {\n    return !this.isOpen;\n  }\n\n  get isSelected() {\n    return this.element.classList.contains('canopy-selected-link');\n  }\n\n  get isGlobal() {\n    return this.type === 'global';\n  }\n\n  get isImport() {\n    return this.type === 'import';\n  }\n\n  get isGlobalOrImport() {\n    return this.type === 'global' || this.type === 'import';\n  }\n\n  get isLocal() {\n    return this.type === 'local';\n  }\n\n  get isParent() {\n    return this.isGlobal || this.isLocal || this.isImport;\n  }\n\n  get hasChildren() {\n    return this.targetParagraph.hasLinks;\n  }\n\n  static select(linkToSelect) {\n    Link.persistInHistory(linkToSelect);\n    Link.persistInSession(linkToSelect);\n    Link.persistLastSelectionData(linkToSelect);\n    document.querySelector('a.canopy-selected-link')?.classList.remove('canopy-selected-link');\n    if (linkToSelect) linkToSelect.element.classList.add('canopy-selected-link');\n  }\n\n  static selectionPresentInEvent(e) {\n    return e.state && Link.containsLinkSelectionMetadata(e.state);\n  }\n\n  static get sessionSelection() {\n    let sessionData = sessionStorage.getItem(Path.current.string);\n    if (sessionData && sessionData !== 'null') {\n      let link = new Link(JSON.parse(sessionData));\n      return link;\n    } else {\n      return null;\n    }\n  }\n\n  static get historySelection() {\n    if (history.state && Link.containsLinkSelectionMetadata(history.state)) {\n      let link = new Link(history.state);\n      return link;\n    } else {\n      return null;\n    }\n  }\n\n  static get priorSelection() {\n    return this.historySelection || this.sessionSelection || null;\n  }\n\n  static get selection() {\n    let selectedLink = document.querySelector('a.canopy-selected-link');\n    if (selectedLink) {\n      return new Link(selectedLink);\n    } else {\n      return null;\n    }\n  }\n\n  static persistInSession(link) {\n    // This has to be static because Link.selection hasn't always updated\n    // between when a new link is selected and when we want to persist that selection\n    let linkData = link && JSON.stringify(link.metadata);\n    sessionStorage.setItem(location.pathname + location.hash, linkData || null);\n  }\n\n  static persistInHistory(link) {\n    // This has to be static because Link.selection hasn't always updated\n    // between when a new link is selected and when we want to persist that selection\n    history.replaceState(\n      link && link.metadata || null,\n      document.title,\n      window.location.href\n    );\n  }\n\n  // selectALink returns a callback that will pick a link to select\n  // once the DOM has rendered.\n  //\n  // selectALink takes a path to clarify which path is intended in case\n  // there are multiple rendered in the DOM, and the path has not updated yet.\n\n  static selectALink(path) {\n    return new Link(() => {\n      path = path || Path.current;\n      let paragraph = path.paragraph;\n      return paragraph.firstLink || paragraph.parentLink;\n    });\n  }\n\n  static current() {\n    throw new Error(\"Link#current does not exist, try Link#selection\");\n  }\n\n  // If someone eg presses up from the second link in a paragraph, pressing down should return them there.\n  static persistLastSelectionData(link) {\n    if (link) {\n      let lastSelectionsOfParagraph = JSON.parse(sessionStorage.getItem('lastSelectionsOfParagraph') || '{}');\n      lastSelectionsOfParagraph[link.enclosingParagraph.path] = link.metadata;\n      sessionStorage.setItem('lastSelectionsOfParagraph', JSON.stringify(lastSelectionsOfParagraph));\n    }\n  }\n\n  static lastSelectionOfParagraph(paragraph) {\n    let lastSelectionsOfParagraph = JSON.parse(sessionStorage.getItem('lastSelectionsOfParagraph') || '{}');\n    if (lastSelectionsOfParagraph[paragraph.path]) {\n      let link = new Link(lastSelectionsOfParagraph[paragraph.path]);\n      try { // sometimes metadata from previous versions is stored and doesn't correspond to real links anymore\n        if (link.element) {\n          return link;\n        }\n      } catch {\n        return null;\n      }\n    }\n  }\n}\n\nexport default Link;\n","import Path from 'models/path';\nimport Link from 'models/link';\nimport { canopyContainer } from 'helpers/getters';\nimport { getAncestorElement } from 'helpers/getters';\nimport Topic from '../../cli/shared/topic';\n\nclass Paragraph {\n  // A paragraph instance represents a visible paragraph, not\n  // specifically the DOM element of type paragraph.\n  //\n  // Visible paragraphs in the UI are created with a section element\n  // that has a paragraph element child.\n  //\n  // paragraph.sectionElement returns the section element, whereas\n  // paragraph.paragraphElement returns the paragraph element.\n\n  constructor(sectionElement) {\n    if (!sectionElement || sectionElement.tagName !== 'SECTION' ) throw new Error(\"Paragraph instantiation requires section element\");\n    if (!sectionElement.classList.contains('canopy-section')) throw new Error(\"Paragraph class requires Canopy section element\");\n    this.sectionElement = sectionElement;\n    this.transferDataset();\n  }\n\n  equals(otherParagraph) {\n    if (!otherParagraph) return false;\n    return this.sectionElement === otherParagraph.sectionElement;\n  }\n\n  allocateSpace() {\n    this.sectionElement.style.display = 'block';\n    this.sectionElement.style.opacity = '0%';\n  }\n\n  display() {\n    this.sectionElement.style.display = 'block';\n    this.sectionElement.style.opacity = '100%';\n  }\n\n  get element() {\n    throw new Error(\"Depreciated in favor of #sectionElement property\");\n  }\n\n  transferDataset() { // This is so we can more easily debug in the console\n    this._topicName = this.sectionElement.dataset.topicName;\n    this._subtopicName = this.sectionElement.dataset.subtopicName;\n    this.pathDepth = this.sectionElement.dataset.pathDepth;\n  }\n\n  get topic () {\n    return Topic.fromMixedCase(this.sectionElement.dataset.topicName);\n  }\n\n  get subtopic () {\n    return Topic.fromMixedCase(this.sectionElement.dataset.subtopicName);\n  }\n\n  get topicName() {\n    throw new Error(\"Depreciated in favor of #topic\");\n  }\n\n  get subtopicName() {\n    throw new Error(\"Depreciated in favor of #subtopic\");\n  }\n\n  get paragraphElement() {\n    let paragraphElement = Array.from(this.sectionElement.childNodes).\n      find((element) => element.tagName === 'P');\n\n    if (!paragraphElement) throw new Error(\"Paragraph has no paragraph element\");\n    return paragraphElement;\n  }\n\n  get path() {\n    let pathArray = [];\n    let currentElement = this.sectionElement;\n    let currentParagraph = this;\n    let currentTopicParagraph = this.topicParagraph;\n\n    while (currentElement !== canopyContainer) {\n      currentTopicParagraph = currentParagraph.topicParagraph;\n\n      pathArray.unshift([\n        Topic.fromMixedCase(currentElement.dataset.topicName),\n        Topic.fromMixedCase(currentElement.dataset.subtopicName)\n      ]);\n\n      while (currentElement !== canopyContainer && currentParagraph.topicParagraph.equals(currentTopicParagraph)) {\n        currentElement = currentElement.parentNode;\n        if (currentElement !== canopyContainer) currentParagraph = new Paragraph(currentElement);\n      }\n    }\n\n    return new Path(pathArray);\n  }\n\n  get links() {\n    if (this.linkObjects) return this.linkObjects;\n    let linkElements = this.paragraphElement.querySelectorAll('a.canopy-selectable-link');\n    this.linkObjects = Array.from(linkElements).map((element) => new Link(element));\n    return this.linkObjects;\n  }\n\n  get firstLink() {\n    return this.links[0] || null;\n  }\n\n  get lastLink() {\n    return this.links[this.links.length - 1] || null;\n  }\n\n  get isPageRoot() {\n    return this.sectionElement.parentNode === canopyContainer\n  }\n\n  get isTopic() {\n    return this.topic.caps === this.subtopic.caps;\n  }\n\n  get hasLinks() {\n    return this.links.length > 0;\n  }\n\n  linkBySelector(callback) {\n    return this.links.find(callback);\n  }\n\n  linksBySelector(callback) {\n    return this.links.filter(callback);\n  }\n\n  linkByTarget(targetTopic, targetSubtopic) {\n    targetSubtopic = targetSubtopic || targetTopic;\n\n    return this.linkBySelector(\n      (link) => link.isParent &&\n        link.targetTopic.caps === targetTopic.caps &&\n        link.targetSubtopic.caps === targetSubtopic.caps\n    );\n  }\n\n  get parentLink() {\n    if (this.sectionElement.parentNode === canopyContainer) { return null; }\n\n    return this.parentParagraph && this.parentParagraph.linkByTarget(\n      this.topic,\n      this.subtopic\n    );\n  }\n\n  get parentLinks() {\n    if (this.sectionElement.parentNode === canopyContainer) { return null; }\n\n    return this.parentParagraph.linksBySelector(\n      link => {\n        return (link.isLocal || link.isGlobal) &&\n          this.topic.caps === link.targetTopic.caps &&\n          this.subtopic.caps === link.targetSubtopic.caps;\n      }\n    );\n  }\n\n  get ancestorImportReferences() {\n    if (this.pageRoot) { return []; }\n    if (!this.topicParagraph.parentParagraph) { return []; }\n\n    return this.topicParagraph.parentParagraph.linksBySelector(\n      link => {\n        return link.isImport &&\n          this.topic.caps === link.targetTopic.caps &&\n          this.subtopic.caps === link.targetSubtopic.caps;\n      }\n    );\n  }\n\n  get displayTopicName() {\n    return this.sectionElement.dataset.displayTopicName;\n  }\n\n  get parentParagraph() {\n    if (this.sectionElement) {\n      let parentElement = getAncestorElement(this.sectionElement, 'canopy-section');\n      return parentElement ? new Paragraph(parentElement) : null;\n    } else {\n      return null;\n    }\n  }\n\n  get topicParagraph() {\n    if (this.isTopic) {\n      return this;\n    } else {\n      return new Paragraph(getAncestorElement(this.sectionElement, 'canopy-topic-section'));\n    }\n  }\n\n  get isTopicRoot() {\n    return this.topicName === this.subtopicName;\n  }\n\n  static get current() {\n    let sectionElement = document.querySelector('.canopy-selected-section');\n    if (sectionElement) {\n      return new Paragraph(sectionElement);\n    } else {\n      return null;\n    }\n  }\n\n  select() {\n    this.sectionElement.classList.add('canopy-selected-section');\n  }\n\n  static get pageRoot() {\n    let path = Path.current.rootTopicPath;\n    return path.paragraph;\n  }\n\n  static containingLink(link) {\n    if (!(link instanceof Link)) throw new Error(\"Must provide link instance argument\");\n    let sectionElement = getAncestorElement(link.element, 'canopy-section');\n    return new Paragraph(sectionElement);\n  }\n\n}\n\nexport default Paragraph;\n","import { defaultTopic, canopyContainer, projectPathPrefix, hashUrls } from 'helpers/getters';\nimport Paragraph from 'models/paragraph';\nimport Topic from '../../cli/shared/topic';\n\nclass Path {\n  constructor(argument) {\n    if (!argument) {\n      this.pathArray = [];\n    } else if (Array.isArray(argument)) {\n      if (argument.length === 0) {\n        this.pathArray = [];\n      } else {\n        this.pathArray = argument.slice();\n        Path.validatePathArray(this.pathArray);\n      }\n      this.pathString = Path.arrayToString(this.pathArray);\n    } else if (typeof argument === 'string' || argument instanceof String) {\n      this.pathArray = Path.stringToArray(argument);\n      this.pathString = Path.arrayToString(this.pathArray); // array formation removes invalid segments so we reform the string\n    }\n  }\n\n  equals(otherPath) {\n    return this.string === otherPath.string;\n  }\n\n  forEach(callback) {\n    this.pathArray.forEach(callback);\n  }\n\n  slice() {\n    return this.pathArray.slice.call(this.pathArray, ...arguments);\n  }\n\n  static validatePathArray(array) {\n    array.forEach(tuple => {\n      if (tuple.length !== 2) throw newError(`Invalid path segment format: ${tuple}`);\n      if (!(tuple[0] instanceof Topic) || !(tuple[1] instanceof Topic)) throw newError(`Invalid path segment format: ${tuple}`);\n    })\n  }\n\n  addSegment(topic, subtopic) {\n    if (this.empty) return new Path([[topic, subtopic]]);\n    return new Path(this.pathArray.concat([[topic, subtopic]]));\n  }\n\n  replaceTerminalSubtopic(newSubtopic) {\n    let lastSegment = this.lastSegment;\n    return this.withoutLastSegment.addSegment(lastSegment.firstTopic, newSubtopic);\n  }\n\n  toString() {\n    return this.string;\n  }\n\n  get array() {\n    return this.pathArray;\n  }\n\n  get string() {\n    return this.pathString;\n  }\n\n  get rootTopicPath() {\n    if (this.length > 0) {\n      return new Path([[this.firstTopic, this.firstTopic]]);\n    } else {\n      return this;\n    }\n  }\n\n  get firstTopic() {\n    return this.pathArray[0][0];\n  }\n\n  get lastTopic() {\n    return this.lastSegment.topic;\n  }\n\n  get topic() {\n    return this.lastSegment.pathArray[0]?.[0];\n  }\n\n  get firstSubtopic() {\n    return this.pathArray[0][1];\n  }\n\n  get secondTopic() {\n    return this.pathArray[1] && this.pathArray[1][0];\n  }\n\n  get secondSubtopic() {\n    return this.pathArray[1] && this.pathArray[1][1];\n  }\n\n  get firstSegment() {\n    return new Path(this.pathArray.slice(0, 1));\n  }\n\n  get lastSegment() {\n    return new Path(this.pathArray.slice(-1));\n  }\n\n  get withoutFirstSegment() {\n    return new Path(this.pathArray.slice(1));\n  }\n\n  get withoutLastSegment() {\n    return new Path(this.pathArray.slice(0, -1));\n  }\n\n  get length() {\n    if (!this.pathArray[0]) {\n      return 0;\n    } else {\n      return this.pathArray.length;\n    }\n  }\n\n  get sectionElement() {\n    return Path.elementAtRelativePath(this, canopyContainer);\n  }\n\n  get paragraph() {\n    if (this.sectionElement) {\n      return new Paragraph(this.sectionElement);\n    } else {\n      return null;\n    }\n  }\n\n  get empty() {\n    return !this.pathArray[0];\n  }\n\n  static get default() {\n    let topic = Topic.for(defaultTopic);\n    return new Path([[topic, topic]]);\n  }\n\n  static get current() {\n    let pathString = window.location.href.slice(window.location.origin.length)\n\n    if (projectPathPrefix && pathString.indexOf(`/${projectPathPrefix}`) === 0) {\n      pathString = pathString.slice(projectPathPrefix.length + 1); // remove prefix and leading slash\n    }\n\n    if (pathString.indexOf('/#') === 0) pathString = pathString.slice(2);  // remove hash sign plus leading slash\n\n    return new Path(pathString);\n  }\n\n  static get currentOrDefault() {\n    if (Path.current.empty) {\n      return Path.default;\n    } else {\n      return Path.current;\n    }\n  }\n\n  static forTopic(topic) {\n    return new Path([[topic, topic]]);\n  }\n\n  static forSegment(topic, subtopic) {\n    return new Path([[topic, subtopic]]);\n  }\n\n  static stringToArray(pathString) {\n    if (typeof pathString !== 'string') throw newError(\"Function requires string argument\");\n\n    if (pathString === '/') {\n      return [];\n    }\n\n    let slashSeparatedUnits = pathString.\n      split('/').\n      filter((string) => string !== '');\n\n    slashSeparatedUnits = Path.fixOrphanSubtopics(pathString, slashSeparatedUnits);\n\n    let pathArray = slashSeparatedUnits.map((slashSeparatedUnit) => {\n      // Capture two groups: (letters)#(optional_more_letters)\n      let match = slashSeparatedUnit.match(/([^#]*)(?:#([^#]*))?/);\n      return [\n        match[1] || match[2] || null,\n        match[2] || match[1] || null,\n      ];\n    }).filter((segment) => segment[0] !== null);\n\n    pathArray = pathArray.map(([topicString, subtopicString]) => [\n      Topic.fromEncodedSlug(topicString),\n      Topic.fromEncodedSlug(subtopicString)\n    ]);\n\n    return pathArray;\n  }\n\n  static arrayToString(pathArray) {\n    if (!Array.isArray(pathArray)) throw newError('Argument must be array');\n\n    if (Array.isArray(pathArray) && pathArray.length === 0) {\n      return '/';\n    }\n\n    if (!Array.isArray(pathArray[0])) {\n      throw newError('Path array must be two-dimensional array');\n    }\n\n    let pathString = '/';\n\n    if (projectPathPrefix) pathString += `${projectPathPrefix}/`;\n\n    if (hashUrls) pathString += '#/';\n\n    pathString += pathArray.map(([topic, subtopic]) => {\n      let pathSegmentString = topic.url;\n      if (subtopic && subtopic.url !== topic.url) {\n        pathSegmentString += \"#\" + subtopic.url;\n      }\n      return pathSegmentString;\n    }).join('/');\n\n    return pathString;\n  }\n\n  static fixOrphanSubtopics(pathString, slashSeparatedUnits) {\n    // Sometimes browsers insert forward slashes before the first pound sign which we have to remove\n    // eg /Topic/#Subtopic/A#B  -> /Topic#Subtopic/A#B\n\n    if (typeof pathString !== 'string') throw newError(\"pathString must be a string argument\");\n    if (!Array.isArray(slashSeparatedUnits)) throw newError('slashSeparatedUnits must be an array');\n\n    if (pathString.match(/\\/#\\w+/)) {\n      for (let i = 1; i < slashSeparatedUnits.length; i++) {\n        if (slashSeparatedUnits[i].match(/^#/)) {\n          if (!slashSeparatedUnits[i - 1].match(/#/)) { // eg /Topic/#Subtopic -> /Topic#Subtopic\n            let newItem = slashSeparatedUnits[i - 1] + slashSeparatedUnits[i];\n            let newArray = slashSeparatedUnits.slice(0, i - 1).\n              concat([newItem]).\n              concat(slashSeparatedUnits.slice(i + 1));\n            return newArray;\n          } else { // eg /Topic#Subtopic/#Subtopic2 -> /Topic#Subtopic/Subtopic2\n            let newItem = slashSeparatedUnits[i].slice(1);\n            let newArray = slashSeparatedUnits.slice(0, i).\n              concat([newItem]).\n              concat(slashSeparatedUnits.slice(i + 1));\n            return newArray;\n          }\n        }\n      }\n    }\n\n    return slashSeparatedUnits;\n  }\n\n  static connectingLinkValid(parentElement, pathToDisplay) {\n    if (!parentElement) throw newError('Parent element required');\n    if (!(pathToDisplay instanceof Path)) throw newError('pathToDisplay must be a Path object');\n\n    if (parentElement === canopyContainer) return true;\n\n    let parentParagraph = new Paragraph(parentElement);\n    if (!parentParagraph.linkByTarget(pathToDisplay.firstTopic)) {\n      console.error(`Parent element [${parentParagraph.topic.mixedCase}, ${parentParagraph.subtopic.mixedCase}] has no ` +\n        `connecting link to subsequent path segment [${pathToDisplay.firstTopic}, ${pathToDisplay.firstTopic}]`);\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  static elementAtRelativePath(path, rootElement) {\n    if (!(path instanceof Path)) throw newError('pathToDisplay must be a Path object');\n    rootElement = rootElement || canopyContainer;\n\n    let currentNode = rootElement;\n    let subpath = path;\n    let currentPathDepth = Number(rootElement.dataset.pathDepth || -1);\n\n    for (let i = 0; i < path.length; i++) {\n      currentPathDepth = currentPathDepth + 1;\n      currentNode = currentNode.querySelector(\n        `:scope > ` + // the next topic must be a direct child of the current subtopic, not some other subtopic with the same global link\n        `[data-topic-name=\"${subpath.firstTopic.escapedMixedCase}\"]` +\n        `[data-subtopic-name=\"${subpath.firstTopic.escapedMixedCase}\"]` +\n        `[data-path-depth=\"${currentPathDepth}\"]` +\n        (subpath.firstTopic.mixedCase !== subpath.firstSubtopic.mixedCase ? // only look for a subtopic if the path segment has one\n        ` ` +\n        `[data-topic-name=\"${subpath.firstTopic.escapedMixedCase}\"]` +\n        `[data-subtopic-name=\"${subpath.firstSubtopic.escapedMixedCase}\"]` +\n        `[data-path-depth=\"${currentPathDepth}\"]` : '')\n      );\n\n      if (!currentNode) return null;\n      subpath = subpath.withoutFirstSegment;\n    }\n\n    return currentNode;\n  }\n\n  static setPath(newPath) {\n    if (!(newPath instanceof Path)) throw newError('newPath must be Path object');\n\n    let oldPath = Path.current;\n    let documentTitle = newPath.firstTopic.display;\n    let historyApiFunction = (Path.current.empty || newPath.equals(oldPath)) ? replaceState : pushState;\n    let fullPathString = newPath.string;\n\n    historyApiFunction(\n      history.state, // this will be changed via Link#persistInHistory\n      documentTitle,\n      fullPathString\n    );\n\n    function replaceState(a, b, c) {\n      history.replaceState(a, b, c);\n    }\n\n    function pushState(a, b, c) {\n      history.pushState(a, b, c);\n    }\n  }\n}\n\nexport default Path;\n","import { canopyContainer, defaultTopic, projectPathPrefix } from 'helpers/getters';\nimport Topic from '../../cli/shared/topic';\nimport updateView from 'display/update_view';\nimport REQUEST_CACHE from 'requests/request_cache';\nimport Path from 'models/path';\nimport { preloadImages } from 'requests/helpers';\n\nconst requestJson = (topic) => {\n  if (REQUEST_CACHE[topic.mixedCase]) return REQUEST_CACHE[topic.mixedCase];\n  let dataPath = (projectPathPrefix ? '/' + projectPathPrefix : '') + '/_data/' + topic.requestFileName + '.json';\n\n  let promise = fetch(dataPath). // to allow preloading JSON from HTML\n    then(res => {\n      return res.json().then((json) => {\n        preloadImages(json);\n        return json;\n      });\n    }).catch(() => {\n      REQUEST_CACHE[topic.mixedCase] = undefined; // in case error is connectivity related & will work again later\n      return Promise.reject(new Error(`Unable to find topic file: \"${topic.requestFileName}\"`));\n    });\n\n  REQUEST_CACHE[topic.mixedCase] = promise;\n\n  return promise;\n}\n\nexport default requestJson;\n","import { canopyContainer } from 'helpers/getters';\n\nfunction preloadImages(parsedJson) {\n  let json = JSON.stringify(parsedJson);\n  canopyContainer.imagePreloadArray = canopyContainer.imagePreloadArray || [];\n\n  const regex = /<img\\s[^>]*?src=\\\\?[\"']([^\"']+?)\\\\?[\"']|resourceUrl\": ?\"([^\"]+)/g;\n\n  [...json.matchAll(regex)].map(m => m[1] || m[2]).forEach(url => {\n    let image = new Image();\n    image.src = url; // this loads and caches the image\n    canopyContainer.imagePreloadArray.push(image); // keep reference to avoid garbage collection\n  });\n}\n\nexport { preloadImages };\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\n\nfunction onLocalLinkClick(targetTopic, targetSubtopic, link) {\n  return (e) => {\n    e.preventDefault();\n    let path, linkToSelect;\n    let newTab = e.metaKey || e.ctrlKey; // mac vs linux and windows\n\n    if (newTab && !e.altKey) { // no zoom\n      return window.open(location.origin + link.targetPath.lastSegment.string, '_blank');\n    }\n\n    if (newTab && e.altKey) { // zoom\n      return window.open(location.origin + link.targetPath.string, '_blank');\n    }\n\n    if (!newTab && e.altKey) { //zoom\n      let path = link.targetPath.lastSegment;\n      return updateView(path, link.atNewPath(path));\n    }\n\n    if (!newTab && !e.altKey && link.isSelected) { // unselect link\n      path = link.parentLink?.path || Path.current.rootTopicPath;\n      return updateView(path);\n    }\n\n    if (!newTab && !e.altKey && !link.isSelected) { // select link\n      path = link.path;\n      linkToSelect = link;\n      return updateView(path, linkToSelect, { scrollTo: 'child' });\n    }\n  };\n}\n\nfunction onGlobalAndImportLinkClick (link) {\n  return (e) => {\n    e.preventDefault();\n    let path, linkToSelect;\n    let newTab = e.metaKey || e.ctrlKey; // mac vs linux and windows\n\n    if (!newTab && !e.altKey && link.isSelected) { // close global child\n      path = link.enclosingParagraph.path;\n      return updateView(path);\n    }\n\n    if (!newTab && !e.altKey && !link.isSelected) { // open global child\n      path = link.path;\n      linkToSelect = link;\n      return updateView(path, linkToSelect, { scrollTo: 'child' });\n    }\n\n    if (!newTab && e.altKey) { // Redirect to global child\n      path = Path.forSegment(link.targetTopic, link.targetSubtopic);\n      return updateView(path, null, { scrollStyle: 'auto', scrollTo: 'child' });\n    }\n\n    if (newTab && e.altKey) { // zoom\n      path = Path.forSegment(link.targetTopic, link.targetSubtopic);\n      return window.open(location.origin + path.string, '_blank');\n    }\n\n    if (newTab && !e.altKey) { // inline\n      path = link.path; // open the link in new tab\n      return window.open(location.origin + path.string, '_blank');\n    }\n  }\n}\n\nexport { onLocalLinkClick, onGlobalAndImportLinkClick };\n","import Path from 'models/path';\nimport Link from 'models/link';\nimport updateView from 'display/update_view';\nimport {\n  setHeader,\n  tryPathPrefix,\n  resetDom,\n  scrollPage,\n} from 'display/helpers';\n\nfunction displayPath (pathToDisplay, linkToSelect, displayOptions) {\n  displayOptions = displayOptions || {};\n  if (!pathToDisplay.paragraph) return tryPathPrefix(pathToDisplay, displayOptions);\n  try { linkToSelect?.element } catch { return updateView(pathToDisplay, null, displayOptions); }\n  if (!pathToDisplay.paragraph.pageRoot && !linkToSelect) linkToSelect = pathToDisplay.paragraph.parentLink;\n  if (linkToSelect?.contradicts(pathToDisplay)) return updateView(linkToSelect.path, linkToSelect, displayOptions);\n\n  resetDom();\n  Path.setPath(linkToSelect?.path || pathToDisplay); // must be done before link.select because selection cache is by current URL\n  let header = setHeader(pathToDisplay.rootTopicPath.topic, displayOptions);\n  document.title = pathToDisplay.rootTopicPath.paragraph.topic.mixedCase;\n  Link.select(linkToSelect); // if null, persists deselect\n\n  let visibleParagraphs = displayPathTo(pathToDisplay.paragraph, [], displayOptions);\n  pathToDisplay.paragraph.select(); // putting this last gives browser tests a DOM change to wait on\n  scrollPage(linkToSelect, displayOptions);\n  setTimeout(() => visibleParagraphs.forEach(paragraph => paragraph.display()) || header.show());\n};\n\nconst displayPathTo = (paragraph, visibleParagraphs, displayOptions) => {\n  if (displayOptions.scrollStyle === 'auto') {\n    paragraph.allocateSpace();\n  } else {\n    paragraph.display();\n  }\n  visibleParagraphs.push(paragraph);\n  if (paragraph.isPageRoot) return visibleParagraphs;\n  paragraph.parentLink && paragraph.parentLinks.forEach(link => link.open());\n  paragraph.ancestorImportReferences.forEach(link => link.open());\n  return displayPathTo(paragraph.parentParagraph, visibleParagraphs, displayOptions);\n}\n\nexport default displayPath;\n","import { canopyContainer } from 'helpers/getters';\nimport displayPath from 'display/display_path';\nimport Link from 'models/link';\nimport Path from 'models/path';\nimport Paragraph from 'models/paragraph';\nimport updateView from 'display/update_view';\nimport renderTokenElement from 'render/render_token_element';\nimport fetchAndRenderPath from 'render/fetch_and_render_path';\n\nfunction setHeader(topic, displayOptions) {\n  let headerDomElement = document.querySelector(`h1[data-topic-name=\"${topic.escapedMixedCase}\"]`);\n  headerDomElement.style.display = 'block';\n  headerDomElement.style.opacity = '0%';\n  if (displayOptions.scrollStyle !== 'auto') {\n    headerDomElement.style.opacity = '100%'; // the page is scrolled to the right position so there wont be a jump\n  }\n  return { show: () => { headerDomElement.style.opacity = '100%' } };\n}\n\nfunction hideAllSectionElements() {\n  Array.from(document.getElementsByTagName(\"section\")).forEach((sectionElement) => {\n    sectionElement.style.display = 'none';\n  });\n}\n\nfunction deselectAllLinks() {\n  Array.from(document.getElementsByTagName(\"a\")).forEach((linkElement) => {\n    linkElement.classList.remove('canopy-selected-link');\n    linkElement.classList.remove('canopy-open-link');\n  });\n}\n\nfunction deselectSectionElement() {\n  Array.from(document.querySelectorAll('.canopy-selected-section')).forEach((sectionElement) => {\n    sectionElement.classList.remove('canopy-selected-section');\n  });\n}\n\nfunction hideHeaders() {\n  Array.from(document.querySelectorAll('#_canopy h1')).forEach(header => {\n    header.style.display = 'none';\n  });\n}\n\nfunction tryPathPrefix(path, displayOptions) {\n  console.error(\"No section element found for path: \", path.string);\n  if (path.length > 1) {\n    console.log(\"Trying: \", path.withoutLastSegment.string);\n    return displayPath(path.withoutLastSegment, null, {scrollStyle: 'auto'});\n  } else if(!displayOptions.defaultRedirect) {\n    console.error(\"No path prefixes remain to try. Redirecting to default topic: \" + Path.default);\n    return updateView(Path.default, null, { defaultRedirect: true, scrollStyle: 'auto' });\n  } else {\n    throw new Error('Redirect to default topic failed terminally.')\n  }\n}\n\nconst resetDom = () => {\n  hideHeaders();\n  deselectAllLinks();\n  hideAllSectionElements();\n  deselectSectionElement();\n}\n\nfunction scrollPage(link, displayOptions) {\n  let behavior = displayOptions.scrollStyle || 'smooth';\n  canopyContainer.dataset.imageLoadScrollBehavior = behavior; // if images later load, follow the most recent scroll behavior\n  if (!Link.selection) return window.scrollTo({ top: 0, behavior })\n  let maxScrollRatio = behavior === 'auto' || displayOptions.scrollTo === 'child' ? Infinity : 0.75; // no limit on initial load and click\n\n  if (displayOptions.scrollTo === 'child') {\n    let sectionElement = link.targetParagraph.sectionElement;\n    scrollElementToPosition(sectionElement, {targetRatio: 0.3, maxScrollRatio, minDiff: 50, behavior, side: 'top' });\n  } else {\n    const linkElement = link?.element;\n    if (linkElement) {\n      scrollElementToPosition(linkElement, {targetRatio: 0.3, maxScrollRatio, minDiff: 50, behavior});\n    } else {\n      scrollElementToPosition(Paragraph.current.sectionElement, {targetRatio: 0, maxScrollRatio, minDiff: 0, behavior});\n    }\n  }\n}\n\nfunction scrollElementToPosition(element, options) {\n  let { targetRatio, maxScrollRatio, minDiff, direction, behavior, side } = options;\n  const rect = element.getBoundingClientRect();\n  const viewportHeight = window.innerHeight;\n  const currentScroll = window.pageYOffset;\n\n  let idealTargetPosition = viewportHeight * targetRatio;\n\n  let pointToPutAtTarget;\n  if (side === 'bottom') {\n    pointToPutAtTarget = rect.bottom;\n  } else if (side === 'top') {\n    pointToPutAtTarget = rect.top;\n  } else {\n    side = 'middle';\n    pointToPutAtTarget = rect.top + (rect.bottom - rect.top) / 2;\n  }\n\n  // Handling large A tags\n  if (element.tagName === 'A' && (side === 'middle' || side === 'bottom')) {\n    const topOffScreen = (side === 'bottom' ? 1 : .5) * (rect.bottom - rect.top) > idealTargetPosition;\n    if (topOffScreen) {\n      targetRatio = 0.05;\n      idealTargetPosition = viewportHeight * targetRatio;\n      pointToPutAtTarget = rect.top;\n    }\n  }\n\n  const idealScrollY = pointToPutAtTarget + currentScroll - idealTargetPosition;\n\n  const maxScrollDistance = viewportHeight * maxScrollRatio;\n  let actualScrollY;\n\n  if (idealScrollY > currentScroll) {\n    actualScrollY = Math.min(idealScrollY, currentScroll + maxScrollDistance);\n  } else {\n    actualScrollY = Math.max(idealScrollY, currentScroll - maxScrollDistance);\n  }\n\n  const diff = Math.abs(currentScroll - actualScrollY);\n  let shouldScroll = diff > minDiff;\n\n  if (direction === 'up') {\n    shouldScroll = shouldScroll && actualScrollY < currentScroll;\n  }\n\n  if (direction === 'down') {\n    shouldScroll = shouldScroll && actualScrollY > currentScroll;\n  }\n\n  if (shouldScroll) {\n    window.scrollTo({ top: actualScrollY, behavior });\n  }\n}\n\nfunction validatePathAndLink(pathToDisplay, linkToSelect) {\n  if (!(pathToDisplay instanceof Path)) throw new Error('Invalid path argument');\n  if (linkToSelect && !(linkToSelect instanceof Link)) throw new Error('Invalid link selection argument');\n}\n\nexport {\n  setHeader,\n  resetDom,\n  tryPathPrefix,\n  scrollPage,\n  validatePathAndLink,\n  scrollElementToPosition\n};\n","import { onLocalLinkClick, onGlobalAndImportLinkClick } from 'render/click_handlers';\nimport externalLinkIconSvg from 'assets/external_link_icon/icon.svg';\nimport Link from 'models/link';\nimport Paragraph from 'models/paragraph';\nimport Topic from '../../cli/shared/topic';\nimport { projectPathPrefix, hashUrls, canopyContainer } from 'helpers/getters';\nimport { scrollPage, imagesLoaded } from 'display/helpers';\n\nfunction renderTokenElement(token, renderContext) {\n  if (token.type === 'text') {\n    return renderTextToken(token);\n  } else if (token.type === 'local') {\n    return renderLocalLink(token, renderContext);\n  } else if (token.type === 'global') {\n    return renderGlobalLink(token, renderContext);\n  } else if (token.type === 'import') {\n    return renderImportLink(token, renderContext);\n  } else if (token.type === 'url') {\n    return renderLinkLiteral(token, renderContext);\n  } else if (token.type === 'image') {\n    return renderImage(token, renderContext);\n  } else if (token.type === 'html_element') {\n    return renderHtmlElement(token);\n  } else if (token.type === 'footnote_marker') {\n    return renderFootnoteSymbol(token);\n  } else if (token.type === 'code_block') {\n    return renderCodeBlock(token);\n  } else if (token.type === 'block_quote') {\n    return renderBlockQuote(token, renderContext);\n  } else if (token.type === 'outline') {\n    return renderList(token.topLevelNodes, renderContext);\n  } else if (token.type === 'table') {\n    return renderTable(token, renderContext)\n  } else if (token.type === 'table_list') {\n    return renderTableList(token, renderContext)\n  } else if (token.type === 'footnote_lines') {\n    return renderFootnoteLines(token, renderContext);\n  } else if (token.type === 'bold') {\n    return renderBoldText(token, renderContext);\n  } else if (token.type === 'strikethrough') {\n    return renderStrikethroughText(token, renderContext);\n  } else if (token.type === 'italics') {\n    return renderItalicText(token, renderContext);\n  } else if (token.type === 'inline_code') {\n    return renderInlineCodeText(token, renderContext);\n  } else {\n    throw `Unhandled token type: ${token.type} ${token.type === 'table_list'}`\n  }\n}\n\nfunction renderTextToken(token) {\n  let spanElement = document.createElement('SPAN');\n  spanElement.innerText = token.text;\n\n  return spanElement;\n}\n\nfunction renderLocalLink(token, renderContext) {\n  let {\n    localLinkSubtreeCallback\n  } = renderContext;\n\n  localLinkSubtreeCallback(token);\n  return createLocalLinkElement(token, renderContext)\n}\n\nfunction createLocalLinkElement(token, renderContext) {\n  let linkElement = document.createElement('a');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.targetTopic = token.targetTopic;\n  linkElement.dataset.targetSubtopic = token.targetSubtopic;\n  linkElement.dataset.enclosingTopic = token.enclosingTopic;\n  linkElement.dataset.enclosingSubtopic = token.enclosingSubtopic;\n  linkElement.dataset.text = token.text;\n\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    linkElement.appendChild(subtokenElement);\n  });\n\n  let callback = onLocalLinkClick(token.targetTopic, token.targetSubtopic, new Link(linkElement));\n\n  linkElement.addEventListener(\n    'click',\n    callback\n  );\n\n  linkElement._CanopyClickHandler = callback\n\n  linkElement.classList.add('canopy-local-link');\n  linkElement.dataset.type = 'local';\n\n  let targetTopic = new Topic(token.targetTopic);\n  let targetSubtopic = new Topic(token.targetSubtopic);\n  linkElement.href = `${projectPathPrefix ? '/' + projectPathPrefix : ''}${hashUrls ? '/#' : ''}/${targetTopic.url}#${targetSubtopic.url}`;\n  return linkElement;\n}\n\nfunction renderGlobalLink(token, renderContext) {\n  let {\n    pathArray,\n    globalLinkSubtreeCallback\n  } = renderContext;\n\n  let linkElement = createGlobalLinkElement(token, renderContext);\n\n  globalLinkSubtreeCallback(token, linkElement);\n\n  return linkElement;\n}\n\nfunction createGlobalLinkElement(token, renderContext) {\n  let linkElement = document.createElement('a');\n\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    linkElement.appendChild(subtokenElement);\n  });\n\n  linkElement.classList.add('canopy-global-link');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.type = 'global';\n\n  linkElement.dataset.targetTopic = token.targetTopic;\n  linkElement.dataset.targetSubtopic = token.targetSubtopic;\n  linkElement.dataset.enclosingTopic = token.enclosingTopic;\n  linkElement.dataset.enclosingSubtopic = token.enclosingSubtopic;\n\n  linkElement.dataset.text = token.text;\n\n  let targetTopic = Topic.fromMixedCase(token.targetTopic);\n  linkElement.href = `${projectPathPrefix ? '/' + projectPathPrefix : ''}${hashUrls ? '/#' : ''}/${targetTopic.url}`;\n\n  let callback = onGlobalAndImportLinkClick(new Link(linkElement))\n\n  linkElement._CanopyClickHandler = callback;\n\n  linkElement.addEventListener(\n    'click',\n    callback\n  );\n  return linkElement\n}\n\nfunction renderImportLink(token, renderContext) {\n  let {\n    pathArray\n  } = renderContext;\n\n  let linkElement = createImportLinkElement(token, renderContext);\n\n  return linkElement;\n}\n\nfunction createImportLinkElement(token, renderContext) {\n  let linkElement = document.createElement('a');\n\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    linkElement.appendChild(subtokenElement);\n  });\n\n  linkElement.classList.add('canopy-import-link');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.type = 'import';\n\n  linkElement.dataset.targetTopic = token.targetTopic;\n  linkElement.dataset.targetSubtopic = token.targetSubtopic;\n  linkElement.dataset.enclosingTopic = token.enclosingTopic;\n  linkElement.dataset.enclosingSubtopic = token.enclosingSubtopic;\n  linkElement.dataset.text = token.text;\n\n  let targetTopic = new Topic(token.targetTopic);\n  let targetSubtopic = new Topic(token.targetSubtopic);\n  linkElement.href = `${projectPathPrefix ? '/' + projectPathPrefix : ''}${hashUrls ? '/#' : ''}/${targetTopic.url}#${targetSubtopic.url}`;\n\n  linkElement.addEventListener(\n    'click',\n    onGlobalAndImportLinkClick(new Link(linkElement))\n  );\n\n  return linkElement\n}\n\nfunction renderLinkLiteral(token, renderContext) {\n  let linkElement = document.createElement('A');\n  linkElement.classList.add('canopy-url-link');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.type = 'url';\n  linkElement.dataset.text = token.text;\n  linkElement.setAttribute('href', token.url);\n  linkElement.setAttribute('target', '_blank');\n\n  let tokensContainer = document.createElement('SPAN');\n  tokensContainer.classList.add('canopy-url-link-tokens-container');\n  linkElement.appendChild(tokensContainer);\n\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    tokensContainer.appendChild(subtokenElement);\n  });\n\n  tokensContainer.innerHTML += '<span class=\"canopy-url-link-tokens-spacing\">&nbsp;&nbsp;</span>';\n\n  let svgContainer = document.createElement('SPAN');\n  svgContainer.classList.add('canopy-url-link-svg-container');\n  svgContainer.innerHTML += externalLinkIconSvg.replace(/\\r?\\n|\\r/g, '');\n  linkElement.appendChild(svgContainer);\n\n  linkElement.innerHTML += '<span class=\"canopy-url-link-svg-spacing\">&nbsp;</span>'; // we don't want this to\n\n  return linkElement;\n}\n\nfunction isVisible(element) {\n  const style = window.getComputedStyle(element);\n  return style.display !== 'none' && style.visibility !== 'hidden';\n}\n\nfunction renderImage(token, renderContext) {\n  let divElement = document.createElement('DIV');\n  divElement.classList.add('canopy-image');\n\n  let imageElement = document.createElement('IMG');\n  imageElement.setAttribute('src', token.resourceUrl);\n  imageElement.setAttribute('decoding', 'async'); // don't wait for image decode to update selected link on change\n\n  let anchorElement = document.createElement('A');\n  anchorElement.setAttribute('href', token.anchorUrl || token.resourceUrl);\n  anchorElement.setAttribute('target', '_blank');\n  anchorElement.classList.add('canopy-image-anchor');\n  anchorElement.appendChild(imageElement);\n  divElement.appendChild(anchorElement);\n\n  if (token.title) {\n    imageElement.setAttribute('title', token.title);\n  }\n\n  if (token.caption) {\n    let spanElement = document.createElement('SPAN');\n    spanElement.classList.add('canopy-image-caption');\n    divElement.appendChild(spanElement);\n\n    token.tokens.forEach(subtoken => {\n      let subtokenElement = renderTokenElement(subtoken, renderContext);\n      spanElement.appendChild(subtokenElement);\n    });\n  } else {\n    divElement.appendChild(anchorElement);\n  }\n\n  if (token.altText) {\n    imageElement.setAttribute('alt', token.altText);\n  }\n\n  imageElement.style.setProperty('height', '700px');\n  imageElement.style.setProperty('opacity', '0');\n  imageElement.addEventListener('load', () => { // if images were unloaded, scroll was delayed and so we do it now to avoid viewport jump\n    imageElement.style.setProperty('height', null);\n    imageElement.style.setProperty('opacity', '1');\n    if (isVisible(imageElement)) scrollPage(Link.selection, { scrollStyle: canopyContainer.dataset.imageLoadScrollBehavior });\n  });\n\n  return divElement;\n}\n\nfunction renderHtmlElement(token) {\n  let divElement = document.createElement('DIV');\n  let fragment = document.createRange().createContextualFragment(token.html); // make script tags functional\n  divElement.appendChild(fragment);\n  divElement.classList.add('canopy-raw-html');\n  [...divElement.querySelectorAll('img')].forEach((imageElement) => { // if the html contains image tags that haven't loaded yet\n    let imageContainer = document.createElement('div');\n    let originalHeight = imageElement.style.height;\n    let originalWidth = imageElement.style.width;\n    let originalOpacity = imageElement.style.opacity;\n    imageElement.style.setProperty('opacity', '0');\n    imageElement.addEventListener('load', () => { // wait for them to load\n      imageElement.style.setProperty('opacity', originalOpacity);\n      if (isVisible(imageElement)) scrollPage(Link.selection, { scrollStyle: canopyContainer.dataset.imageLoadScrollBehavior });\n    });\n  });\n  return divElement;\n}\n\nfunction renderFootnoteSymbol(token) {\n  let superscriptElement = document.createElement('SUP');\n  let textNode = document.createTextNode(token.text);\n  superscriptElement.appendChild(textNode);\n  return superscriptElement;\n}\n\nfunction renderCodeBlock(token) {\n  let preElement = document.createElement('PRE');\n  let codeBlockElement = document.createElement('CODE');\n  preElement.appendChild(codeBlockElement);\n\n  codeBlockElement.innerText = token.text;\n\n  return preElement;\n}\n\nfunction renderBlockQuote(token, renderContext) {\n  let blockQuoteElement = document.createElement('BLOCKQUOTE');\n  blockQuoteElement.setAttribute('dir', token.direction);\n\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    blockQuoteElement.appendChild(subtokenElement);\n  });\n\n  return blockQuoteElement;\n}\n\nfunction renderList(listNodeObjects, renderContext) {\n  let listElement = listNodeObjects[0].ordered ?\n    document.createElement('OL') :\n    document.createElement('UL');\n\n  if (listNodeObjects[0].ordered) {\n    listElement.setAttribute('type', listNodeObjects[0].ordinal);\n  }\n\n  listNodeObjects.forEach((listNodeObject) => {\n    let listItemElement = document.createElement('LI');\n\n    listNodeObject.tokensOfLine.forEach(\n      (token) => {\n        let tokenElement = renderTokenElement(token, renderContext);\n        listItemElement.appendChild(tokenElement);\n      }\n    );\n\n    if (listNodeObject.children.length > 0) {\n      let childList = renderList(listNodeObject.children);\n      listItemElement.appendChild(childList);\n    }\n\n    listElement.appendChild(listItemElement);\n  });\n  return listElement;\n}\n\nfunction renderTable(token, renderContext) {\n  let tableElement = document.createElement('TABLE');\n  tableElement.setAttribute('dir', 'auto');\n  if (token.rtl) tableElement.setAttribute('dir', 'rtl');\n\n  token.rows.forEach(\n    (row) => {\n      let tableRowElement = document.createElement('TR');\n      if (token.rtl) tableRowElement.setAttribute('dir', 'rtl');\n\n      row.forEach(\n        (cellObject) => {\n          let tableCellElement = document.createElement('TD');\n          if (cellObject.hidden) tableCellElement.classList.add('hidden');\n\n          cellObject.tokens.forEach(\n            (token) => {\n              let tokenElement = renderTokenElement(token, renderContext);\n\n              if (cellObject.colspan) tableCellElement.setAttribute('colspan', cellObject.colspan);\n              if (cellObject.rowspan) tableCellElement.setAttribute('rowspan', cellObject.rowspan);\n\n              if (cellObject.tokens.length === 1 && tokenElement.tagName === 'A') {\n                tableCellElement.classList.add('canopy-table-link-cell');\n                tokenElement.classList.add('canopy-table-link');\n                tableCellElement.addEventListener('click', tokenElement._CanopyClickHandler);\n                tokenElement.removeEventListener('click', tokenElement._CanopyClickHandler)\n              }\n\n              tableCellElement.appendChild(tokenElement);\n            }\n          );\n\n          if (!cellObject.merge) {\n            tableRowElement.appendChild(tableCellElement);\n          }\n        }\n      )\n      tableElement.appendChild(tableRowElement);\n    }\n  );\n  return tableElement;\n}\n\nfunction renderTableList(token, renderContext) {\n  let containerElement = document.createElement('DIV');\n  containerElement.classList.add('canopy-table-list-container');\n  let tableListElement = document.createElement('DIV');\n\n  tableListElement.classList.add('canopy-table-list');\n  if (token.rtl) tableListElement.dir = 'rtl';\n  containerElement.appendChild(tableListElement);\n\n  let SizesByWidth = ['quarter', 'third', 'half'];\n  let SizesByArea = ['quarter-pill', 'third-pill', 'half-pill', 'quarter-card', 'third-card', 'half-card'];\n\n  let tableCellSize;\n  let minimumCellArea = 'quarter-pill';\n  let minimumCellWidth = 'quarter';\n  if (token.items.length === 2) tableCellSize = 'third-pill'; // even if content doesn't justify size, we expand if there aren't so many\n  if (token.items.length === 3) tableCellSize = 'third-pill';\n\n  let cellElements = token.items.map(cellObject => {\n    let tableCellElement = document.createElement('DIV');\n    tableCellElement.classList.add('canopy-table-list-cell');\n\n    let contentContainer = document.createElement('DIV');\n    contentContainer.classList.add('canopy-table-list-content-container');\n    let tokenElement = renderTokenElement(cellObject.tokens[0], renderContext);\n    if (cellObject.tokens.length === 1 && tokenElement.tagName === 'A') {\n      tokenElement.classList.add('canopy-table-list-cell');\n      tokenElement.classList.add('canopy-table-list-link-cell');\n      tableCellElement = tokenElement;\n      while (tokenElement.firstChild) contentContainer.appendChild(tokenElement.firstChild);\n      tokenElement.appendChild(contentContainer);\n    } else {\n      tableCellElement.appendChild(contentContainer);\n      cellObject.tokens.forEach(token => {\n        tokenElement = renderTokenElement(token, renderContext);\n        contentContainer.appendChild(tokenElement);\n        tableCellElement.appendChild(contentContainer);\n      });\n    }\n\n    if (cellObject.list) {\n      let ordinalElement = document.createElement('SPAN');\n      ordinalElement.classList.add('canopy-table-list-ordinal');\n      ordinalElement.innerHTML = cellObject.ordinal + '.&nbsp;';\n      contentContainer.prepend(ordinalElement);\n      contentContainer.classList.add('canopy-align-left');\n    }\n\n    // determine cell size\n    let longestWord = tableCellElement.innerText.split(' ').sort((a, b) => b.length - a.length)[0];\n    let longestWordLength = longestWord.length;\n    let totalLength = tableCellElement.innerText.length;\n\n    let sizeOptionsBasedOnLargestWordLength;\n    if (longestWordLength < 16) { // 0 - 10 eg \"Acknowledgements\"\n      if (SizesByWidth.indexOf(minimumCellWidth) < SizesByWidth.indexOf('quarter')) minimumCellWidth = 'quarter';\n    } else if (longestWordLength < 21) { // 10-30\n      if (SizesByWidth.indexOf(minimumCellWidth) < SizesByWidth.indexOf('third')) minimumCellWidth = 'third';\n    } else {\n      minimumCellWidth = 'half';\n    }\n\n    if (totalLength < 17) {\n      if (SizesByArea.indexOf(minimumCellArea) < SizesByArea.indexOf('quarter-pill')) minimumCellArea = 'quarter-pill';\n    } else if (totalLength < 22) {\n      if (SizesByArea.indexOf(minimumCellArea) < SizesByArea.indexOf('third-pill')) minimumCellArea = 'third-pill';\n    } else if (totalLength < 29 && token.items.length <= 2) {\n      if (SizesByArea.indexOf(minimumCellArea) < SizesByArea.indexOf('half-pill')) minimumCellArea = 'half-pill';\n    } else if (totalLength < 29) {\n      if (SizesByArea.indexOf(minimumCellArea) < SizesByArea.indexOf('quarter-card')) minimumCellArea = 'quarter-card';\n    } else if (totalLength < 51) {\n      if (SizesByArea.indexOf(minimumCellArea) < SizesByArea.indexOf('third-card')) minimumCellArea = 'third-card';\n    } else {\n      if (SizesByArea.indexOf(minimumCellArea) < SizesByArea.indexOf('half-card')) minimumCellArea = 'half-card';\n    }\n\n    tableCellSize = SizesByArea.find((newSize, index) => {\n      if (SizesByWidth.indexOf(minimumCellWidth) > SizesByWidth.indexOf(newSize.match(/^[a-z]+/)[0])) return false;\n      if (SizesByArea.indexOf(minimumCellArea) > SizesByArea.indexOf(newSize)) return false;\n      return true; // otherwise update tableCellSize\n    });\n\n    return tableCellElement;\n  });\n\n  let id = setInterval(() => { // once elements are in DOM and have height, make heights consistent\n    if (setLargestHeightToAll(cellElements)) clearInterval(id);\n  }, 0)\n\n  containerElement.classList.add(`canopy-${tableCellSize}`);\n\n  // Function to create a new row\n  function createNewRow() {\n    let newRow = document.createElement('DIV');\n    newRow.classList.add('canopy-table-list-row');\n    if (token.rtl) newRow.dir = 'rtl';\n    tableListElement.appendChild(newRow);\n    return newRow;\n  }\n\n  let rowSize;\n  if (tableCellSize.includes('half')) rowSize = 2;\n  if (tableCellSize.includes('third')) rowSize = 3;\n  if (tableCellSize.includes('quarter')) rowSize = 4;\n\n  // Create the first row\n  let tableRowElement = createNewRow();\n\n  // Assuming cellElements is your array of cells\n  for (let i = 0; i < cellElements.length; i++) {\n    // Append cell to current row\n    tableRowElement.appendChild(cellElements[i]);\n\n    // If row is full and there are more cells to add, create a new row\n    if ((i + 1) % rowSize === 0 && (i + 1) !== cellElements.length) {\n      tableRowElement = createNewRow();\n    }\n  }\n\n  return containerElement;\n\n  function getLargestHeight(elements) {\n    let largestHeight = 0;\n    elements.forEach(element => {\n      let computedHeight = window.getComputedStyle(element).height;\n      let height = parseFloat(computedHeight);\n      if (height > largestHeight) {\n        largestHeight = height;\n      }\n    });\n    return largestHeight;\n  }\n\n  function setLargestHeightToAll(elements) {\n    let largestHeight = getLargestHeight(elements);\n    if (largestHeight === 0) return false;\n    elements.forEach(element => {\n      element.style.height = largestHeight + 'px';\n    });\n    if (largestHeight > 0) return true;\n  }\n}\n\nfunction renderHtmlBlock(token) {\n  let htmlContainer = document.createElement('DIV');\n  htmlContainer.innerHTML = token.html;\n  htmlContainer.classList.add('canopy-raw-html');\n  return htmlContainer;\n}\n\nfunction renderFootnoteLines(footnoteLinesToken, renderContext) {\n  let div = document.createElement('DIV');\n  let horizonalRule = document.createElement('HR');\n  horizonalRule.classList.add('canopy-footnote-rule');\n  div.appendChild(horizonalRule)\n\n  footnoteLinesToken.lines.forEach(line => {\n    let footnoteSpan = document.createElement('SPAN');\n    footnoteSpan.classList.add('canopy-footnote-span');\n    let textNode = document.createTextNode(line.superscript + '. ');\n    footnoteSpan.appendChild(textNode);\n    line.tokens.forEach((token) => {\n      let tokenElement = renderTokenElement(token, renderContext);\n      footnoteSpan.appendChild(tokenElement);\n    });\n\n    div.appendChild(footnoteSpan);\n  });\n\n  return div;\n}\n\nfunction renderBoldText(token, renderContext) {\n  let element = document.createElement('B');\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    element.appendChild(subtokenElement);\n  });\n  return element;\n}\nfunction renderStrikethroughText(token, renderContext) {\n  let element = document.createElement('S');\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    element.appendChild(subtokenElement);\n  });\n  return element;\n}\n\nfunction renderItalicText(token, renderContext) {\n  let element = document.createElement('I');\n  token.tokens.forEach(subtoken => {\n    let subtokenElement = renderTokenElement(subtoken, renderContext);\n    element.appendChild(subtokenElement);\n  });\n  return element;\n}\n\nfunction renderInlineCodeText(token, renderContext) {\n  let element = document.createElement('CODE');\n  element.innerText = token.text;\n  return element;\n}\n\nexport default renderTokenElement;\n","export default \"<svg xmlns:svg=\\\"http://www.w3.org/2000/svg\\\"\\n   xmlns=\\\"http://www.w3.org/2000/svg\\\"\\n   version=\\\"1.0\\\"\\n   width=\\\"12\\\"\\n   height=\\\"12\\\"\\n   id=\\\"svg2\\\">\\n  <defs id=\\\"defs4\\\"></defs>\\n  <rect\\n     width=\\\"5.9999995\\\"\\n     height=\\\"6\\\"\\n     x=\\\"1.5\\\"\\n     y=\\\"4.5\\\"\\n     id=\\\"rect3170\\\"\\n     style=\\\"fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:#0066cc;stroke-width:0.99999994;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1\\\"></rect>\\n  <path\\n     d=\\\"M 4,2.5 L 5,3.5 L 5.25,4.25 L 2.75,6.5 L 5.5,9.25 L 7.75,6.75 L 8.5,7 L 9.5,8 L 11,6.5 L 11,1 L 5.5,1 L 4,2.5 z\\\"\\n     id=\\\"path2395\\\"\\n     style=\\\"fill:#0066ff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\\\"></path>\\n  <path\\n     d=\\\"M 6,2 L 10,2 L 10,6 L 9.5,6.75 L 8.25,4.75 L 5.25,8 L 4,6.75 L 7.25,3.75 L 5.25,2.5 L 6,2 z\\\"\\n     id=\\\"path2398\\\"\\n     style=\\\"fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\\\" ></path>\\n</svg>\\n\";","import fetchAndRenderPath from 'render/fetch_and_render_path';\nimport requestJson from 'requests/request_json';\nimport Paragraph from 'models/paragraph';\nimport Link from 'models/link';\nimport Topic from '../../cli/shared/topic';\nimport renderTokenElement from 'render/render_token_element';\n\nfunction renderDomTree(renderContext) {\n  let {\n    subtopic,\n    paragraphsBySubtopic\n  } = renderContext;\n\n  let sectionElement = createSectionElement(renderContext);\n  let paragraph = new Paragraph(sectionElement);\n\n  renderContext.displayBlockingPromises = [];\n  renderContext.localLinkSubtreeCallback = localLinkSubtreeCallback(sectionElement, renderContext);\n  renderContext.globalLinkSubtreeCallback = globalLinkSubtreeCallback(sectionElement, renderContext);\n\n  let tokensOfParagraph = paragraphsBySubtopic[subtopic.mixedCase];\n  if (!tokensOfParagraph) throw new Error(`Paragraph with subtopic not found: ${subtopic.mixedCase}`);\n\n  tokensOfParagraph.forEach((token) => {\n    let element = renderTokenElement(token, renderContext);\n    paragraph.paragraphElement.appendChild(element);\n  });\n\n  return Promise.all(renderContext.displayBlockingPromises).then(() => sectionElement);\n}\n\nfunction localLinkSubtreeCallback(sectionElement, renderContext) {\n  return (token) => {\n    let promisedSubtree = renderDomTree(\n      Object.assign({}, renderContext, {\n        subtopic: Topic.fromMixedCase(token.targetSubtopic)\n      })\n    );\n\n    promisedSubtree.then((subtree) => {\n      sectionElement.appendChild(subtree);\n    });\n\n    renderContext.displayBlockingPromises.push(promisedSubtree);\n  }\n}\n\nfunction globalLinkSubtreeCallback(sectionElement, renderContext) {\n  let {\n    pathToDisplay,\n    subtopic,\n    displayBlockingPromises\n  } = renderContext;\n\n  return (token, linkElement) => {\n    let topic = Topic.fromMixedCase(token.targetTopic);\n    let link = new Link(linkElement);\n    requestJson(topic); // eager-load and cache\n\n    if (globalLinkIsOpen(link, pathToDisplay, subtopic)) {\n      let newPath = pathToDisplay.withoutFirstSegment;\n      let whenTopicTreeAppended = fetchAndRenderPath(newPath, sectionElement);\n      displayBlockingPromises.push(whenTopicTreeAppended)\n    }\n  }\n}\n\nfunction createSectionElement(renderContext) {\n  let {\n    topic, subtopic, displayTopicName, pathDepth, paragraphsBySubtopic\n  } = renderContext;\n\n  let sectionElement = document.createElement('section');\n  sectionElement.classList.add('canopy-section');\n  let paragraphElement = document.createElement('p');\n  paragraphElement.classList.add('canopy-paragraph');\n  sectionElement.appendChild(paragraphElement);\n  sectionElement.style.display = 'none';\n  sectionElement.style.opacity = '0';\n  sectionElement.dataset.displayTopicName = displayTopicName;\n  sectionElement.dataset.topicName = topic.mixedCase;\n  sectionElement.dataset.subtopicName = subtopic.mixedCase;\n  sectionElement.dataset.pathDepth = pathDepth;\n  let tokens = paragraphsBySubtopic[topic.mixedCase];\n\n  if (topic.mixedCase === subtopic.mixedCase) {\n    if (pathDepth > 0 && tokens.length > 0) sectionElement.prepend(document.createElement('hr'));\n    sectionElement.classList.add('canopy-topic-section');\n  }\n\n  return sectionElement;\n}\n\n// When rendering the links of a paragraph, is a given link the parent link of\n// the next paragraph in the visible path?\n\nfunction globalLinkIsOpen(link, path, currentlyRenderingSubtopic) {\n  let subtopicOfPathContainingOpenGlobalReference = path.firstSubtopic;\n  let openGlobalLinkExists = path.secondTopic;\n\n  let openGlobalLinkTargetTopic = path.secondTopic;\n  let openGlobalLinkTargetSubtopic = openGlobalLinkTargetTopic;\n\n  // Is the given global link's target the same as the next path segment's topic?\n  let thisGlobalLinkIsPointingToTheRightThingToBeOpen =\n    link.targetTopic.mixedCase === openGlobalLinkTargetTopic?.mixedCase &&\n    link.targetSubtopic.mixedCase === openGlobalLinkTargetSubtopic?.mixedCase;\n\n  // Is this global link in the currently visible lowest subtopic of the given\n  let thisGlobalLinkIsInCorrectSubtopicToBeOpen = currentlyRenderingSubtopic.mixedCase ===\n    subtopicOfPathContainingOpenGlobalReference.mixedCase;\n\n  return openGlobalLinkExists &&\n    thisGlobalLinkIsPointingToTheRightThingToBeOpen &&\n    thisGlobalLinkIsInCorrectSubtopicToBeOpen;\n}\n\nexport default renderDomTree;\n","import renderDomTree from 'render/render_dom_tree';\nimport requestJson from 'requests/request_json';\nimport Path from 'models/path';\nimport { canopyContainer } from 'helpers/getters';\nimport { generateHeader } from 'render/helpers';\n\nconst fetchAndRenderPath = (pathToDisplay, parentElement) => {\n  if (pathToDisplay.length === 0) {\n    return Promise.resolve(null);\n  }\n\n  pathToDisplay.slice(1).forEach(([topic]) => { requestJson(topic) }); // preload later path segments\n\n  let preexistingElement = Path.elementAtRelativePath(pathToDisplay.firstSegment, parentElement);\n  if (preexistingElement) {\n    if (!Path.connectingLinkValid(parentElement, pathToDisplay)) return Promise.resolve();\n    return fetchAndRenderPath(pathToDisplay.withoutFirstSegment, preexistingElement);\n  }\n\n  let uponResponsePromise = requestJson(pathToDisplay.firstTopic);\n\n  let uponRender = uponResponsePromise.then(({ paragraphsBySubtopic, displayTopicName, topicTokens }) => {\n    let headerElement = parentElement === canopyContainer ? // generate header if paragraph is root\n      Promise.resolve(generateHeader(topicTokens, displayTopicName)) : null;\n\n    let sectionElement = renderDomTree(\n      {\n        topic: pathToDisplay.firstTopic,\n        subtopic: pathToDisplay.firstTopic,\n        pathToDisplay,\n        displayTopicName,\n        paragraphsBySubtopic,\n        pathDepth: Number(parentElement.dataset.pathDepth) + 1 || 0\n      },\n    );\n\n    return Promise.all([sectionElement, headerElement]);\n  });\n\n  return uponRender.then(([ sectionElement, headerElement ]) => {\n    headerElement && canopyContainer.prepend(headerElement);\n    parentElement.appendChild(sectionElement);\n  });\n}\n\nexport default fetchAndRenderPath;\n","import Topic from '../../cli/shared/topic';\nimport renderTokenElement from './render_token_element';\n\nfunction generateHeader(topicTokens, displayTopicName) {\n  let topic = new Topic(displayTopicName);\n\n  let headerElement = document.createElement('h1');\n  headerElement.dataset.topicName = topic.mixedCase;\n\n  topicTokens.forEach(token => {\n    let element = renderTokenElement(token);\n    headerElement.appendChild(element);\n  });\n\n  return headerElement\n}\n\nexport { generateHeader };\n","import fetchAndRenderPath from 'render/fetch_and_render_path';\nimport displayPath from 'display/display_path';\nimport Link from 'models/link';\nimport Path from 'models/path';\nimport { canopyContainer } from 'helpers/getters';\nimport { validatePathAndLink } from 'display/helpers';\n\nconst updateView = (pathToDisplay, linkToSelect, displayOptions) => {\n  validatePathAndLink(pathToDisplay, linkToSelect);\n  if (pathToDisplay.empty) pathToDisplay = Path.default;\n  document.title = pathToDisplay.firstTopic.mixedCase;\n\n  let newTreeAppended = fetchAndRenderPath(pathToDisplay, canopyContainer).catch(e => console.error(e));\n\n  return newTreeAppended.then(() => {\n    displayPath(\n      pathToDisplay,\n      linkToSelect,\n      displayOptions\n    );\n  }).catch(e => console.error(e));\n}\n\nexport default updateView;\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\nimport Paragraph from 'models/paragraph';\nimport { scrollElementToPosition } from 'display/helpers';\n\nfunction moveToParent() {\n  let link = Link.selection;\n\n  let parentLink = link && link.parentLink && Link.lastSelectionOfParagraph(link.parentLink?.enclosingParagraph) || link.parentLink;\n\n  // Use the isVisible function to check visibility.\n  if (!parentLink) { // eg link in root paragraph\n    if (!isVisible(link)) {\n      let sectionElement = Link.selection.enclosingParagraph.sectionElement;\n      scrollElementToPosition(sectionElement, {targetRatio: 0.75, maxScrollRatio: 0.75, minDiff: 0, direction: 'up', behavior: 'smooth'});\n    } else {\n      if (!link.enclosingParagraph.equals(Paragraph.pageRoot)) throw 'this should never happen';\n      return updateView(link.enclosingParagraph.path); // deselect link\n    }\n  } else { // there is a parent link\n    if (!isVisible(parentLink)) {\n      scrollElementToPosition(parentLink.element, {targetRatio: 0.3, maxScrollRatio: 0.75, minDiff: 50, direction: 'up', behavior: 'smooth'});\n    } else {\n      return updateView(\n        link.parentLink.path,\n        new Link(() => Link.lastSelectionOfParagraph(link.parentLink.enclosingParagraph) || link.parentLink)\n      );\n    }\n  }\n}\n\nfunction topicParentLink() {\n  let link = Link.selection;\n  let newLink = Link.lastSelectionOfParagraph(link.enclosingParagraph.topicParagraph.parentParagraph) ||\n    link.enclosingParagraph.topicParagraph.parentLink;\n\n  return updateView(\n    newLink?.path || Path.current,\n    newLink || link\n  );\n}\n\nfunction moveToChild() {\n  let oldLink = Link.selection;\n\n  if (oldLink.isImport) {\n    updateView(\n      oldLink.path,\n      oldLink.targetParagraph.parentLink\n    );\n  }\n\n  if (oldLink.isGlobal || oldLink.isLocal) {\n    let newLink = oldLink.targetParagraph?.firstLink || oldLink.targetParagraph?.parentLink;\n\n    updateView(\n      newLink.path,\n      new Link(() => Link.lastSelectionOfParagraph(newLink.enclosingParagraph) || newLink)\n    );\n  }\n\n  if (!oldLink.isParent) {\n    updateView(\n      oldLink.path,\n      oldLink\n    );\n  }\n}\n\nfunction moveDownOrRedirect({ newTab, altKey }) {\n  let link, path;\n\n  if (Link.selection.isLocal && (Link.selection.targetParagraph.hasLinks || altKey)) {\n    link = Link.selection.targetParagraph?.firstLink || Link.selection.targetParagraph?.parentLink;\n    path = link.path;\n\n    if (newTab) {\n      return window.open(location.origin + path, '_blank'); // zoom\n    } else if (isVisible(link)) {\n      return updateView(path, link); // no zoom\n    }\n  }\n\n  if (Link.selection.isGlobal && (Link.selection.targetParagraph.hasLinks || altKey)) {\n    if (!altKey) {\n      link =\n        Link.lastSelectionOfParagraph(Link.selection.targetParagraph) ||\n        Link.selection.targetParagraph?.firstLink;\n      path = link.path;\n    } else {\n      path = Link.selection.targetPath.lastSegment;\n    }\n\n    if (newTab) {\n      return window.open(location.origin + path.string, '_blank');\n    } else if (altKey) {\n      return updateView(\n        path,\n        null,\n        { scrollStyle: 'auto' }\n      )\n    } else if (isVisible(link)) {\n      return updateView(path, link);\n    }\n  }\n\n  if (Link.selection.isImport && (Link.selection.targetParagraph.hasLinks || altKey)) {\n    if (!altKey) {\n      link = Link.selection.targetParagraph?.parentLink;\n      path = link.path;\n    } else {\n      path = Link.selection.targetPath.lastSegment;\n    }\n\n    if (newTab) {\n      return window.open(location.origin + path.string, '_blank');\n    } else if (altKey) {\n      return updateView(\n        path,\n        Link.selection.parentLink.atNewPath(path),\n        { scrollStyle: 'auto' }\n      )\n    } else if (isVisible(link)) {\n      return updateView(path);\n    }\n  }\n\n  if (Link.selection.type === 'url') {\n    return window.open(Link.selection.element.href, '_blank');\n  }\n\n  // If no child link or child link is not visible, scroll downwards\n  if (link) {\n    let linkElement = link.element;\n    scrollElementToPosition(linkElement, {targetRatio: 0.25, maxScrollRatio: 0.75, minDiff: 50, direction: 'down', behavior: 'smooth', side: 'bottom'});\n  } else {\n    let sectionElement = Link.selection.targetParagraph.sectionElement;\n    scrollElementToPosition(sectionElement, {targetRatio: 0.2, maxScrollRatio: 0.75, minDiff: 50, direction: 'down', behavior: 'smooth', side: 'bottom'});\n  }\n}\n\nfunction isVisible(link) {\n  if (!link) return false;\n  let linkElement = link.element;\n  let rect = linkElement.getBoundingClientRect();\n  let windowHeight = window.innerHeight;\n  let windowWidth = window.innerWidth;\n\n  // Calculate the area of the element that is visible in the viewport\n  let visibleWidth = Math.min(rect.right, windowWidth) - Math.max(rect.left, 0);\n  let visibleHeight = Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0);\n\n  // Calculate the total area of the element and the area that is visible\n  let totalArea = (rect.bottom - rect.top) * (rect.right - rect.left);\n  let visibleArea = visibleHeight * visibleWidth;\n\n  // Check if at least 50% of the element is visible\n  return (visibleArea / totalArea) >= 0.5;\n}\n\nfunction depthFirstSearch() {\n  let link = Link.selection;\n\n  // Open a parent link\n  if (link.isLocal && link.hasChildren) {\n    let nextLink = link.firstChildLink || link.nextSibling || link;\n    return updateView(\n      nextLink.path,\n      nextLink\n    );\n  }\n\n  if (link.isGlobalOrImport) {\n    let linkToSelect = link.nextSibling || link.parentLink?.nextSibling || link.enclosingParagraph.firstLink;\n    return updateView(\n      linkToSelect.enclosingParagraph.path,\n      linkToSelect\n    );\n  }\n\n  // Move to the next sibling including parent link with no children\n  if (link.nextSibling && !link.nextSibling.equals(link)) {\n    return updateView(\n      link.nextSibling.enclosingParagraph.path,\n      link.nextSibling,\n    );\n  }\n\n  // Move to next parent sibling, grandparent sibling, etc.\n  if (link.lastSibling.equals(link)) {\n    let linkToSelect = (function parentSibling (link) {\n      if (!(link.parentLink && link.parentLink.isLocal)) { // If there is no parent link that is local\n        return link.firstSibling; // cycle\n      } else if (link.parentLink.nextSibling) { // If there is a parent-sibling link select that\n        return link.parentLink.nextSibling;\n      } else {\n        return parentSibling(link.parentLink) // otherwise repeat the above steps using the local parent link\n      }\n    })(link);\n\n    return updateView(\n      linkToSelect.path,\n      linkToSelect\n    );\n  }\n}\n\nfunction browserBack() { // an undo for DFS\n  let oldPathname = window.location.pathname;\n  history.back();\n  if (oldPathname !== window.location.pathname) { // we aren't undoing a DFS\n    history.forward();\n  }\n}\n\nfunction copyDecodedUrl() {\n  navigator.clipboard.writeText(decodeURIComponent(window.location));\n}\n\nfunction goToDefaultTopic() {\n  return updateView(\n    Path.default,\n    null\n  );\n}\n\nfunction zoomOnLocalPath() {\n  let currentLink = Link.selection;\n  let newPath = currentLink.localPathSegmentWhenSelected;\n\n  let newLink = currentLink.atNewPath(newPath);\n\n  return updateView(\n    newPath,\n    newLink,\n    { scrollStyle: 'auto' }\n  );\n}\n\nfunction removeSelection() {\n  return updateView(Path.current.rootTopicPath, null, { scrollStyle: 'auto' });\n}\n\nfunction duplicate() {\n  return window.open(window.location.href, '_blank');\n}\n\nexport {\n  moveToParent,\n  moveToChild,\n  moveDownOrRedirect,\n  topicParentLink,\n  depthFirstSearch,\n  zoomOnLocalPath,\n  removeSelection,\n  duplicate,\n  browserBack,\n  copyDecodedUrl,\n  goToDefaultTopic\n};\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\nimport Paragraph from 'models/paragraph';\nimport { scrollElementToPosition } from 'display/helpers';\n\nfunction moveInDirection(direction) {\n  const currentLinkElement = Link.selection.element;\n\n  if (direction === 'up') {\n    let candidateLinks = Array.from(document.querySelectorAll('.canopy-selectable-link')).filter(link => link.offsetParent !== null);\n    let currentSelectionHigherRect = getBoundingRectInDirection(currentLinkElement, 'up');\n    let currentSelectionLowerRect = getBoundingRectInDirection(currentLinkElement, 'down');\n    let rectContainers = getRectsOfElements(candidateLinks, currentLinkElement);\n\n    let candidateRectContainers = rectContainers\n      .filter(rectObject => isHigher(rectObject, currentSelectionLowerRect) && !isVerticallyOverlapping(rectObject, currentSelectionLowerRect))\n      .filter(rect => rect.element !== currentLinkElement);\n\n    if (candidateRectContainers.length === 0) {\n      if (currentSelectionLowerRect.top < -10) {\n        return scrollElementToPosition(currentLinkElement, {targetRatio: 0.25, maxScrollRatio: 0.75, minDiff: 50, direction: 'up', behavior: 'smooth'});\n      } else {\n        return updateView(Paragraph.pageRoot.path);\n      }\n    }\n\n    let lowestHigherRect = candidateRectContainers\n      .reduce((lowestHigherRect, newRect) => {\n        if (Link.selection.parentLink?.element === lowestHigherRect.element) { // lowestHigherRect is the parent link of current paragraph\n          if (newRect.element.closest('p.canopy-paragraph') === lowestHigherRect.element.closest('p.canopy-paragraph')) { // newRect is also in p of parent link\n            return lowestHigherRect; // prefer parent over closer sibling\n          }\n        }\n\n        if (Link.selection.parentLink?.element === newRect.element) { // newRect is the parent link of current paragraph\n          if (newRect.element.closest('p.canopy-paragraph') === lowestHigherRect.element.closest('p.canopy-paragraph')) { // lowestHigherRect is also in p of parent link\n            return newRect; // prefer parent over closer sibling\n          }\n        }\n\n        if (isLower(lowestHigherRect, newRect) &&\n          !isVerticallyOverlapping(lowestHigherRect, newRect) &&\n          !isVerticallyOverlapping(lowestHigherRect, currentSelectionLowerRect)) return lowestHigherRect; // of those links that are higher than current selection, prefer lower if noticeable\n\n        if (isLower(newRect, lowestHigherRect) &&\n          !isVerticallyOverlapping(lowestHigherRect, newRect) &&\n          !isVerticallyOverlapping(newRect, currentSelectionLowerRect)) return newRect;\n\n        if (isHorizontallyWithin(currentSelectionHigherRect, lowestHigherRect)) return lowestHigherRect;\n        if (isHorizontallyWithin(currentSelectionHigherRect, newRect)) return newRect;\n        if (isHorizontallyWithin(lowestHigherRect, currentSelectionHigherRect) && !isHorizontallyWithin(newRect, currentSelectionHigherRect)) return lowestHigherRect;\n        if (isHorizontallyWithin(newRect, currentSelectionHigherRect) && !isHorizontallyWithin(lowestHigherRect, currentSelectionHigherRect)) return newRect;\n\n        if (isHorizontallyOverlapping(lowestHigherRect, currentSelectionHigherRect) && !isHorizontallyOverlapping(newRect, currentSelectionHigherRect)) return lowestHigherRect;\n        if (isHorizontallyOverlapping(newRect, currentSelectionHigherRect) && !isHorizontallyOverlapping(lowestHigherRect, currentSelectionHigherRect)) return newRect;\n\n        if (lowestHigherRect.element.closest('p.canopy-paragraph') === Link.selection.parentLink.enclosingParagraph.paragraphElement) { // going up to new paragraph\n          if (isHorizontallyOverlapping(lowestHigherRect, currentSelectionHigherRect) && isHorizontallyOverlapping(newRect, currentSelectionHigherRect)) {\n            return greaterHorizontalOverlap(currentSelectionHigherRect, lowestHigherRect, newRect);\n          } else {\n            return horizontallyCloserRect(lowestHigherRect, newRect, currentSelectionHigherRect);\n          }\n        } else { // going up in same paragraph\n          if (isHorizontallyOverlapping(lowestHigherRect, currentSelectionLowerRect) && isHorizontallyOverlapping(newRect, currentSelectionLowerRect)) {\n            return greaterHorizontalOverlap(currentSelectionLowerRect, lowestHigherRect, newRect);\n          } else {\n            return horizontallyCloserRect(lowestHigherRect, newRect, currentSelectionLowerRect);\n          }\n        }\n      });\n\n    scrollOrSelect(lowestHigherRect);\n\n  } else if (direction === 'down') {\n    let candidateLinks = Array.from(document.querySelectorAll('.canopy-selectable-link')).filter(link => link.offsetParent !== null);\n    let currentSelectionHigherRect = getBoundingRectInDirection(currentLinkElement, 'up');\n    let currentSelectionLowerRect = getBoundingRectInDirection(currentLinkElement, 'down');\n    let rectContainers = getRectsOfElements(candidateLinks, currentLinkElement);\n\n    let candidateRectContainers = rectContainers\n      .filter(rectObject => isLower(rectObject, currentSelectionHigherRect) && !isVerticallyOverlapping(rectObject, currentSelectionHigherRect))\n      .filter(rect => rect.element !== currentLinkElement);\n\n    if (candidateRectContainers.length === 0) {\n      let sectionElement = Paragraph.current.sectionElement;\n      return scrollElementToPosition(sectionElement, {targetRatio: 0.4, maxScrollRatio: 0.75, minDiff: 50, direction: 'down', behavior: 'smooth', side: 'bottom'});\n    }\n\n    let highestLowerRect = candidateRectContainers\n      .reduce((highestLowerRect, newRect) => {\n        if (isHigher(highestLowerRect, newRect) &&\n          !isVerticallyOverlapping(highestLowerRect, newRect) &&\n          !isVerticallyOverlapping(highestLowerRect, currentSelectionHigherRect)) return highestLowerRect; // prefer the higher element if noticeably higher\n\n        if (isHigher(newRect, highestLowerRect) &&\n          !isVerticallyOverlapping(highestLowerRect, newRect) &&\n          !isVerticallyOverlapping(newRect, currentSelectionHigherRect)) return newRect;\n\n        if (isHorizontallyWithin(currentSelectionHigherRect, highestLowerRect)) return highestLowerRect;\n        if (isHorizontallyWithin(currentSelectionHigherRect, newRect)) return newRect;\n        if (isHorizontallyWithin(highestLowerRect, currentSelectionHigherRect) && !isHorizontallyWithin(newRect, currentSelectionHigherRect)) return highestLowerRect;\n        if (isHorizontallyWithin(newRect, currentSelectionHigherRect) && !isHorizontallyWithin(highestLowerRect, currentSelectionHigherRect)) return newRect;\n\n        if (highestLowerRect.element.closest('p.canopy-paragraph') === Link.selection.targetParagraph.paragraphElement) { // going down into new paragraph\n          if (isHorizontallyOverlapping(highestLowerRect, currentSelectionLowerRect) && !isHorizontallyOverlapping(newRect, currentSelectionLowerRect)) return highestLowerRect;\n          if (isHorizontallyOverlapping(newRect, currentSelectionLowerRect) && !isHorizontallyOverlapping(highestLowerRect, currentSelectionLowerRect)) return newRect;\n          if (Paragraph.current.links[0].element === highestLowerRect.element) return highestLowerRect; // prefer first link if it is close\n          if (Paragraph.current.links[0].element === newRect.element) return newRect;\n          return greaterHorizontalOverlap(currentSelectionHigherRect, highestLowerRect, newRect);\n        } else { // going down in same paragraph\n          if (isHorizontallyOverlapping(highestLowerRect, currentSelectionHigherRect) && !isHorizontallyOverlapping(newRect, currentSelectionHigherRect)) return highestLowerRect;\n          if (isHorizontallyOverlapping(newRect, currentSelectionHigherRect) && !isHorizontallyOverlapping(highestLowerRect, currentSelectionHigherRect)) return newRect;\n          return greaterHorizontalOverlap(currentSelectionLowerRect, highestLowerRect, newRect);\n        }\n      });\n\n    scrollOrSelect(highestLowerRect);\n\n  } else if (direction === 'left') {\n    let candidateLinks = Link.selection.element.closest('p.canopy-paragraph').querySelectorAll('.canopy-selectable-link');\n    let currentSelectionRect = getBoundingRectInDirection(currentLinkElement, 'right');\n    let rectContainers = getRectsOfElements(candidateLinks, currentLinkElement);\n\n    let candidateRectContainers = rectContainers.filter(rectObject => rectObject.right < currentSelectionRect.right);\n    candidateRectContainers = candidateRectContainers.filter(rectObject => isVerticallyOverlapping(rectObject, currentSelectionRect));\n    candidateRectContainers = candidateRectContainers.filter(rectObject => rectObject.element !== currentLinkElement);\n\n    if (candidateRectContainers.length > 0) {\n      let rightmostLeftRect = candidateRectContainers\n        .reduce((rightmostLeftRect, newRect) => {\n          if (rightmostLeftRect.bottom === currentSelectionRect.bottom && newRect.bottom !== currentSelectionRect.bottom) return rightmostLeftRect; // prefer direct left\n          if (newRect.bottom === currentSelectionRect.bottom && rightmostLeftRect.bottom !== currentSelectionRect.bottom) return newRect;\n          if (rightmostLeftRect.right > newRect.right) return rightmostLeftRect;\n          if (rightmostLeftRect.right < newRect.right) return newRect;\n          if (rightmostLeftRect.right === newRect.right) {\n            let yDistanceFromCurrentToBest = distanceComparingSide(currentSelectionRect, rightmostLeftRect, 'bottom');\n            let yDistanceFromCurrentToNew = distanceComparingSide(currentSelectionRect, newRect, 'bottom');\n            return yDistanceFromCurrentToBest > yDistanceFromCurrentToNew ? newRect : rightmostLeftRect;\n          }\n        });\n\n      if (rightmostLeftRect) {\n        return scrollOrSelect(rightmostLeftRect);\n      }\n    }\n\n    // Wrap to upward far-right for LTR (or downward far-left for rtl)\n    let verticalDirectionOfWrap = verticalDirectionToWrapAfterLeftmostLink(currentLinkElement);\n    let horizontalDirectionOfWrap = horizontalDirectionToWrapAfterLink(currentLinkElement, verticalDirectionOfWrap);\n    let verticalSideToCompare = verticalDirectionOfWrap === 'up' ? 'bottom' : 'top';\n    let isInCorrectVerticalDirection = verticalDirectionOfWrap === 'up' ? isHigher : isLower; // has to be eg upward in general\n    let isInBetterVerticalDirection = verticalDirectionOfWrap === 'up' ? isLower : isHigher; // but of the upward links, eg, lower is better\n    let closerToCorrectHorizontalEdge = horizontalDirectionOfWrap === 'right' ? rightMostRect : leftMostRect;\n\n    candidateRectContainers = rectContainers.filter(rectObject => isInCorrectVerticalDirection(rectObject, currentSelectionRect));\n    candidateRectContainers = candidateRectContainers.filter(rectObject => !isVerticallyOverlapping(rectObject, currentSelectionRect)); // if left and right accept overlap wrap must not\n    candidateRectContainers = candidateRectContainers.filter(rectObject => rectObject.element !== currentLinkElement);\n\n    if (candidateRectContainers.length > 0) {\n      let rightmostUpwardRect = candidateRectContainers // name reflects LTR text\n        .reduce((rightmostUpwardRect, newRect) => {\n          if (isInBetterVerticalDirection(rightmostUpwardRect, newRect) && !isVerticallyOverlapping(rightmostUpwardRect, newRect)) return rightmostUpwardRect;\n          if (isInBetterVerticalDirection(newRect, rightmostUpwardRect) && !isVerticallyOverlapping(rightmostUpwardRect, newRect)) return newRect;\n          return closerToCorrectHorizontalEdge(rightmostUpwardRect, newRect);\n        });\n\n      if (rightmostUpwardRect) {\n        return scrollOrSelect(rightmostUpwardRect);\n      }\n    }\n\n    // Wrap to rightmost bottom (or leftmost top for RTL)\n    let verticalDirectionOfExtremeWrap = verticalDirectionToWrapAfterFinalLeftmostLink(currentLinkElement);\n    let horizontalDirectionOfExtremeWrap = horizontalDirectionToWrapAfterExtremeLink(currentLinkElement, verticalDirectionOfExtremeWrap);\n    let verticalSideToCompareExtremeWrap = verticalDirectionOfExtremeWrap === 'down' ? 'top' : 'bottom';\n    let horizontalSideToCompareExtremeWrap = horizontalDirectionOfExtremeWrap;\n    let isVerticallyFarther = verticalDirectionOfExtremeWrap === 'up' ? isHigher : isLower;\n    let closerToCorrectExtremeHorizontalEdge = horizontalDirectionOfExtremeWrap === 'right' ? rightMostRect : leftMostRect;\n\n    let rightBottomMostRect = rectContainers // Name reflects LTR text\n      .reduce((rightBottomMostRect, newRect) => {\n        if (isVerticallyFarther(rightBottomMostRect, newRect)  && !isVerticallyOverlapping(rightBottomMostRect, newRect)) return rightBottomMostRect;\n        if (isVerticallyFarther(newRect, rightBottomMostRect) &&  !isVerticallyOverlapping(rightBottomMostRect, newRect)) return newRect;\n        return closerToCorrectExtremeHorizontalEdge(rightBottomMostRect, newRect);\n      });\n\n    if (rightBottomMostRect) {\n      return scrollOrSelect(rightBottomMostRect);\n    }\n\n  } else if (direction === 'right') {\n    let candidateLinks = Link.selection.element.closest('p.canopy-paragraph').querySelectorAll('.canopy-selectable-link');\n    let currentSelectionRect = getBoundingRectInDirection(currentLinkElement, 'left');\n    let rectContainers = getRectsOfElements(candidateLinks, currentLinkElement);\n\n    let candidateRectContainers = rectContainers.filter(rectObject => rectObject.left > currentSelectionRect.left);\n    candidateRectContainers = candidateRectContainers.filter(rectObject => isVerticallyOverlapping(rectObject, currentSelectionRect));\n    candidateRectContainers = candidateRectContainers.filter(rectObject => rectObject.element !== currentLinkElement);\n\n    if (candidateRectContainers.length > 0) {\n      let leftmostRightRect = candidateRectContainers\n        .reduce((leftmostRightRect, newRect) => {\n          if (leftmostRightRect.bottom === currentSelectionRect.bottom && newRect.bottom !== currentSelectionRect.bottom) return leftmostRightRect; // prefer direct right\n          if (newRect.bottom === currentSelectionRect.bottom && leftmostRightRect.bottom !== currentSelectionRect.bottom) return newRect;\n          if (leftmostRightRect.left < newRect.left) return leftmostRightRect;\n          if (leftmostRightRect.left > newRect.left) return newRect;\n          if (leftmostRightRect.left === newRect.left) {\n            return topMostRect(leftmostRightRect, newRect);\n          }\n        });\n\n      if (leftmostRightRect) {\n        return scrollOrSelect(leftmostRightRect);\n      }\n    }\n\n    // Wrap to downward far-left (or upward far-right for RTL text)\n    let verticalDirectionOfWrap = verticalDirectionToWrapAfterRightmostLink(currentLinkElement);\n    let horizontalDirectionOfWrap = horizontalDirectionToWrapAfterLink(currentLinkElement, verticalDirectionOfWrap);\n    let verticalSideToCompare = verticalDirectionOfWrap === 'up' ? 'top' : 'bottom';\n    let horizontalSideToCompare = horizontalDirectionOfWrap;\n    let isInCorrectVerticalDirection = verticalDirectionOfWrap === 'up' ? isHigher : isLower;\n    let isInBetterVerticalDirection = verticalDirectionOfWrap === 'up' ? isLower : isHigher;\n    let isHorizontalExtreme = horizontalDirectionOfWrap === 'left' ? isLeftward : isRightward;\n    let closerToCorrectHorizontalEdge = horizontalDirectionOfExtremeWrap === 'right' ? rightMostRect : leftMostRect;\n\n    candidateRectContainers = rectContainers.filter(rectObject => isInCorrectVerticalDirection(rectObject, currentSelectionRect));\n    candidateRectContainers = candidateRectContainers.filter(rectObject => !isVerticallyOverlapping(rectObject, currentSelectionRect)); // if left and right accept overlap wrap must not\n    candidateRectContainers = candidateRectContainers.filter(rectObject => rectObject.element !== currentLinkElement);\n\n    if (candidateRectContainers.length > 0) {\n      let leftmostDownwardRect = candidateRectContainers // Name reflects LTR text\n        .reduce((leftmostDownwardRect, newRect) => {\n          if (isInBetterVerticalDirection(leftmostDownwardRect, newRect) && !isVerticallyOverlapping(leftmostDownwardRect, newRect)) return leftmostDownwardRect;\n          if (isInBetterVerticalDirection(newRect, leftmostDownwardRect) && !isVerticallyOverlapping(newRect, leftmostDownwardRect)) return newRect;\n          return closerToCorrectHorizontalEdge(leftmostDownwardRect, newRect);\n        });\n\n      if (leftmostDownwardRect) {\n        return scrollOrSelect(leftmostDownwardRect);\n      }\n    }\n\n    // Wrap to leftmost top (or rightmost bottom for RTL)\n    let verticalDirectionOfExtremeWrap = verticalDirectionToWrapAfterFinalRightmostLink(currentLinkElement);\n    let horizontalDirectionOfExtremeWrap = horizontalDirectionToWrapAfterExtremeLink(currentLinkElement, verticalDirectionOfExtremeWrap);\n    let extremeHorizontalPosition = horizontalDirectionOfExtremeWrap === 'left' ? 0 : window.innerWidth;\n    let verticalSideToCompareExtremeWrap = verticalDirectionOfExtremeWrap === 'up' ? 'top' : 'bottom';\n    let horizontalSideToCompareExtremeWrap = horizontalDirectionOfExtremeWrap;\n    let isVerticallyFarther = verticalDirectionOfExtremeWrap === 'up' ? isHigher : isLower;\n    let closerToCorrectHorizontalExtremeEdge = horizontalDirectionOfExtremeWrap === 'right' ? rightMostRect : leftMostRect;\n\n    let leftmostTopRect = rectContainers\n      .reduce((leftmostTopRect, newRect) => {\n        if (isVerticallyFarther(leftmostTopRect, newRect)) return leftmostTopRect;\n        if (isVerticallyFarther(newRect, leftmostTopRect)) return newRect;\n        if (leftmostTopRect[verticalSideToCompareExtremeWrap] === newRect[verticalSideToCompareExtremeWrap]) {\n          return closerToCorrectHorizontalExtremeEdge(leftmostTopRect, newRect);\n        }\n      });\n\n    if (leftmostTopRect) {\n      return scrollOrSelect(leftmostTopRect);\n    }\n  }\n}\n\nfunction isHigher(rect1, rect2) {\n  if (rect1.bottom < rect2.bottom) return true;\n  return false;\n}\n\nfunction isLower(rect1, rect2) {\n  if (rect1.top > rect2.top) return true;\n  return false;\n}\n\nfunction bottomsAreEven(rect1, rect2) {\n  if (rect1.bottom === rect2.bottom) return true;\n  return false;\n}\n\nfunction topsAreEven(rect1, rect2) {\n  if (rect1.top === rect2.top) return true;\n  return false;\n}\n\nfunction isHorizontallyEvenWith(rect1, rect2) {\n  if (Math.abs(rect1.top - rect2.top) < 30) return true;\n  return false;\n}\n\nfunction isRightward(rect1, rect2) {\n  if (rect1.left > rect2.left) return true;\n  return false;\n}\n\nfunction isLeftward(rect1, rect2) {\n  if (rect1.right < rect2.right) return true;\n  return false;\n}\n\nfunction rightMostRect(rect1, rect2) {\n  return rect1.right > rect2.right ? rect1 : rect2;\n}\n\nfunction leftMostRect(rect1, rect2) {\n  return rect1.left < rect2.left ? rect1 : rect2;\n}\n\nfunction topMostRect(rect1, rect2) {\n  return rect1.top < rect2.top ? rect1 : rect2;\n}\n\nfunction bottomMostRect(rect1, rect2) {\n  return rect1.bottom > rect2.bottom ? rect1 : rect2;\n}\n\nfunction isHorizontallyWithin(rect1, rect2) {\n  if (rect1.left > rect2.left && rect1.right < rect2.right) return true;\n  return false;\n}\n\nfunction isHorizontallyOverlapping(rect1, rect2) {\n  return (rect1.left < rect2.right && rect2.left < rect1.right);\n}\n\nfunction isVerticallyOverlapping(rect1, rect2) {\n  return (\n    (rect1.top <= rect2.bottom && rect1.bottom >= rect2.top) ||\n    (rect2.top <= rect1.bottom && rect2.bottom >= rect1.top)\n  );\n}\n\nfunction horizontallyCloserRect(rect1, rect2, targetRect) {\n  const midpointRect1 = (rect1.left + rect1.right) / 2;\n  const midpointRect2 = (rect2.left + rect2.right) / 2;\n  const midpointTarget = (targetRect.left + targetRect.right) / 2;\n\n  const distanceToRect1 = Math.abs(midpointRect1 - midpointTarget);\n  const distanceToRect2 = Math.abs(midpointRect2 - midpointTarget);\n\n  if (distanceToRect1 < distanceToRect2) {\n    return rect1;\n  } else {\n    return rect2;\n  }\n}\n\nfunction scrollOrSelect(rect) {\n  const amountOfLinkThatMustBeVisibleToSelect = 15;\n  if (rect.top > window.innerHeight - amountOfLinkThatMustBeVisibleToSelect) {\n    return scrollElementToPosition(rect.element, {targetRatio: 0.2, maxScrollRatio: 0.75, minDiff: 50, direction: 'down', behavior: 'smooth'});\n  } else if (rect.bottom < amountOfLinkThatMustBeVisibleToSelect) {\n    return scrollElementToPosition(rect.element, {targetRatio: 0.25, maxScrollRatio: 0.75, minDiff: 50, direction: 'up', behavior: 'smooth'});\n  } else {\n    const link = new Link(rect.element);\n    return updateView(link.path, link);\n  }\n}\n\nfunction greaterHorizontalOverlap(selectedRect, candidateRect1, candidateRect2) {\n  function calculateHorizontalOverlap(rect1, rect2) {\n    return Math.max(0, Math.min(rect1.right, rect2.right) - Math.max(rect1.left, rect2.left));\n  }\n\n  const overlap1 = calculateHorizontalOverlap(selectedRect, candidateRect1);\n  const overlap2 = calculateHorizontalOverlap(selectedRect, candidateRect2);\n\n  if (overlap1 > overlap2) {\n    return candidateRect1;\n  } else {\n    return candidateRect2;\n  }\n}\n\nfunction distanceComparingSide(rect1, rect2, side) {\n  if (typeof rect1 === 'number') rect1 = { [side]: rect1 };\n  if (typeof rect2 === 'number') rect2 = { [side]: rect2 };\n\n  switch (side) {\n    case 'left':\n      return Math.abs(rect1.left - rect2.left);\n    case 'right':\n      return Math.abs(rect1.right - rect2.right);\n    case 'top':\n      return Math.abs(rect1.top - rect2.top);\n    case 'bottom':\n      return Math.abs(rect1.bottom - rect2.bottom);\n    case 'middle':\n      return Math.abs(((rect1.left - rect1.right)/2) - ((rect2.left - rect2.right)/2));\n    default:\n      // Invalid side\n      return null;\n  }\n}\n\nfunction getRectsOfElements(elementArray, currentLinkElement) {\n  const result = [];\n\n  for (const element of elementArray) {\n    let elementForRect = element;\n    if (element.parentNode.tagName === 'TD' && element.parentNode.childNodes.length === 1) elementForRect = element.parentNode; // a link in TD should use the TD's borders\n\n    const subRects = Array.from(elementForRect.getClientRects());\n    let singleRect = { element, text: element.innerText, ...JSON.parse(JSON.stringify(elementForRect.getBoundingClientRect()))};\n\n    if (commonAncestorIsContainer(element, currentLinkElement)) { // a link in a DIV is one rect unlike links in wrapping text\n      result.push(singleRect);\n    } else {\n      for (let i = 0; i < subRects.length; i++) { // treat multiple rects of same link as separate candidates\n        const rect = subRects[i];\n        result.push({\n          x: rect.x,\n          y: rect.y,\n          width: rect.width,\n          height: rect.height,\n          top: rect.top,\n          right: rect.right,\n          bottom: rect.bottom,\n          left: rect.left,\n          element: element,\n          text: element.innerText\n        });\n      }\n    }\n  }\n\n  return result;\n}\n\nfunction commonAncestorIsContainer(element, currentLinkElement) {\n  let ancestor1 = element;\n  let ancestor2 = currentLinkElement;\n\n  while (ancestor1 !== null) {\n    let tempAncestor2 = ancestor2;\n    while (tempAncestor2 !== null) {\n      if (ancestor1 === tempAncestor2) {\n        return ['DIV', 'TABLE', 'TR'].includes(ancestor1.tagName); // these containers imply links are not in free-form wrapped text\n      }\n      tempAncestor2 = tempAncestor2.parentElement;\n    }\n    ancestor1 = ancestor1.parentElement;\n  }\n  return false;\n}\n\nfunction getBoundingRectInDirection(element, direction) {\n  let singleRect = JSON.parse(JSON.stringify(element.getBoundingClientRect()));\n  let multipleRects = mergeRectsWithSameTop(getTextNodesRects(element));\n\n  if (multipleRects.length === 1 || linkTextIsOneUnit(element)) return { element, ...singleRect};\n  if (multipleRects.length === 0) return null;\n\n  switch(direction) {\n    case 'left':\n      return { element, ...multipleRects.reduce((leftmostRect, currentRect) => {\n        return currentRect.right > leftmostRect.right ? leftmostRect : currentRect;\n      })};\n    case 'right':\n      return { element, ...multipleRects.reduce((rightmostRect, currentRect) => {\n        return currentRect.left < rightmostRect.left ?  rightmostRect : currentRect;\n      })};\n    case 'up':\n      return { element, ...multipleRects.reduce((uppermostRect, currentRect) => {\n        return currentRect.bottom < uppermostRect.bottom ? currentRect : uppermostRect;\n      })};\n    case 'down':\n      return { element, ...multipleRects.reduce((lowestRect, currentRect) => {\n        return currentRect.top > lowestRect.top ? currentRect : lowestRect;\n      })};\n    default:\n      throw new Error(\"Invalid direction argument\");\n  }\n\n  function linkTextIsOneUnit(linkElement) { // is wrapped text new unit for proximity calculations or is container one unit?\n    return linkElement.closest('p.canopy-paragraph > div') || linkElement.closest('p.canopy-paragraph > table'); // descendants of a div are not inline, unlike direct children of <p> or eg <b>\n  }\n}\n\nfunction getTextNodesRects(element) {\n  const textNodesRects = [];\n\n  function traverse(node) {\n    if (node.nodeType === Node.TEXT_NODE) {\n      const range = document.createRange();\n      range.selectNodeContents(node);\n      const rects = range.getClientRects();\n      for (let i = 0; i < rects.length; i++) {\n        textNodesRects.push(rects[i]);\n      }\n    } else if (node.nodeType === Node.ELEMENT_NODE) {\n      for (const childNode of node.childNodes) {\n        traverse(childNode);\n      }\n    }\n  }\n\n  traverse(element);\n  return textNodesRects.map(rect => JSON.parse(JSON.stringify(rect)));\n}\n\nfunction mergeRectsWithSameTop(rectangles) {\n  const mergedRectangles = [];\n\n  // Sort the rectangles by their top value\n  rectangles.sort((rect1, rect2) => rect1.top - rect2.top);\n\n  let currentRect = rectangles[0];\n\n  for (let i = 1; i < rectangles.length; i++) {\n    const nextRect = rectangles[i];\n\n    // Check if the top values are the same\n    if (currentRect.top === nextRect.top) {\n      // Merge the rectangles horizontally\n      currentRect.left = Math.min(currentRect.left, nextRect.left);\n      currentRect.right = Math.max(currentRect.right, nextRect.right);\n    } else {\n      // Add the current merged rectangle to the result\n      mergedRectangles.push(currentRect);\n\n      // Set the current rectangle to the next one\n      currentRect = nextRect;\n    }\n  }\n\n  // Add the last merged rectangle to the result\n  mergedRectangles.push(currentRect);\n\n  return mergedRectangles;\n}\n\n// ** Direction wrap handling **\n\n// When the user presses right or left, whether we wrap up or down depends on the current text direction,\n// but if we wrap down, whether to pick the right-most link or the left-most link of the lower links\n// depends on the text orientation of their container, not the current container, so this function\n// finds the next link vertically and determines its text orientation in order to decide which side to pick from.\n\nfunction verticalDirectionToWrapAfterRightmostLink(linkElement) {\n  return getTextDirectionOfRootAncestor(linkElement) === 'ltr' ? 'down' : 'up';\n}\n\nfunction verticalDirectionToWrapAfterLeftmostLink(linkElement) {\n  return getTextDirectionOfRootAncestor(linkElement) === 'ltr' ? 'up' : 'down';\n}\n\nfunction verticalDirectionToWrapAfterFinalRightmostLink(linkElement) {\n  return getTextDirectionOfRootAncestor(linkElement) === 'ltr' ? 'up' : 'down';\n}\n\nfunction verticalDirectionToWrapAfterFinalLeftmostLink(linkElement) {\n  return getTextDirectionOfRootAncestor(linkElement) === 'ltr' ? 'down' : 'up';\n}\n\n// Unlike the vertical direction of the wrap, the horiztonal direction of the wrap is dependent of the text direction\n// of the _next_ link that will get selected, not the current one, and so is not necessarily the opposite horizontal direction of wrap\nfunction horizontalDirectionToWrapAfterLink(linkElement, verticalDirectionOfWrap) {\n  if (verticalDirectionOfWrap === 'up') {\n    return getTextDirectionOfRootAncestor(getPreviousLinkOfParagraph(linkElement)) === 'ltr' ? 'right' : 'left';\n  } else if (verticalDirectionOfWrap === 'down') {\n    return getTextDirectionOfRootAncestor(getNextLinkOfParagraph(linkElement)) === 'ltr' ? 'left' : 'right';\n  }\n}\n\n// This is when in LTR text we go 'right' on the bottom right link or 'left' on the top-left link and cycle on x and y\nfunction horizontalDirectionToWrapAfterExtremeLink(linkElement, verticalDirectionOfWrap) {\n  if (verticalDirectionOfWrap === 'up') {\n    return getTextDirectionOfRootAncestor(getPreviousLinkOfParagraph(linkElement)) === 'ltr' ? 'left' : 'right';\n  } else if (verticalDirectionOfWrap === 'down') {\n    return getTextDirectionOfRootAncestor(getNextLinkOfParagraph(linkElement)) === 'ltr' ? 'right' : 'left';\n  }\n}\n\nfunction getNextLinkOfParagraph(linkElement) {\n  let paragraphElement = linkElement.closest('p.canopy-paragraph');\n  let allLinks = Array.from(paragraphElement.querySelectorAll('.canopy-selectable-link'));\n  let currentLinkIndex = allLinks.indexOf(Link.selection.element);\n\n  if (currentLinkIndex < allLinks.length - 1) {\n    return allLinks[currentLinkIndex + 1];\n  } else {\n    return Link.selection.element;\n  }\n}\n\nfunction getPreviousLinkOfParagraph(linkElement) {\n  let paragraphElement = linkElement.closest('p.canopy-paragraph');\n  let allLinks = Array.from(paragraphElement.querySelectorAll('.canopy-selectable-link'));\n  let currentLinkIndex = allLinks.indexOf(Link.selection);\n\n  if (currentLinkIndex > 0) {\n    return allLinks[currentLinkIndex - 1];\n  } else {\n    return Link.selection.element;\n  }\n}\n\nfunction getTextDirectionOfRootAncestor(element) { // allow manual override of rtl eg for english names of semetic works\n  return element.dir === 'rtl' ? 'rtl' : detectTextDirection(getHighestAncestor(element).innerText);\n}\n\nfunction getHighestAncestor(element) { // find the ancestor element that is a direct child of the paragraph element\n  while(element.parentNode !== Link.selection.element.closest('p.canopy-paragraph')) {\n    element = element.parentNode;\n  }\n  return element;\n}\n\nfunction detectTextDirection(text) {\n  // Regular expression patterns for different character ranges\n  const rtlChars = '\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC';\n  const ltrChars = 'A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF' +\n                   '\\u2C00-\\uFB1C\\uFDFE-\\uFE6F\\uFEFD-\\uFFFF';\n  const rtlDirCheck = new RegExp(`^[^${ltrChars}]*[${rtlChars}]`);\n\n  // Check if the text is RTL\n  return rtlDirCheck.test(text) ? 'rtl' : 'ltr';\n}\n\n\nexport {\n  moveInDirection\n}\n","import {\n  topicParentLink,\n  moveToParent,\n  moveToChild,\n  moveDownOrRedirect,\n  depthFirstSearch,\n  zoomOnLocalPath,\n  removeSelection,\n  duplicate,\n  browserBack,\n  copyDecodedUrl,\n  goToDefaultTopic\n} from 'keys/key_handlers';\nimport { moveInDirection } from 'keys/arrow_keys';\nimport updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\nimport Paragraph from 'models/paragraph';\n\nconst registerKeyListeners = () => {\n  window.addEventListener('keydown', function(e) {\n    if (document.activeElement.tagName === \"INPUT\") return; // User is typing in text box\n\n    let modifiers =\n      (e.metaKey ? 'meta-' : '') +\n      (e.ctrlKey ? 'ctrl-' : '') +\n      (e.altKey ? 'alt-' : '') +\n      (e.shiftKey ? 'shift-' : '');\n\n    let keyName = keyNames[e.keyCode];\n    let shortcutName = modifiers + keyName;\n    if (['tab', 'down', 'up', 'left', 'right'].includes(keyName)) {\n      if (!((e.metaKey || e.ctrlKey) && ['left', 'right'].includes(keyName))) { // unless browser back\n        e.preventDefault();\n      }\n    }\n\n    if (keyName === 'escape' && !Link.selection) {\n      return goToDefaultTopic();\n    }\n\n    if (Link.selection) {\n      (shortcutRelationships[shortcutName]||function(){})()\n    } else if (shortcutRelationships[shortcutName]) {\n      updateView(\n        Path.current,\n        Link.lastSelectionOfParagraph(Paragraph.pageRoot) || Link.selectALink()\n      );\n    }\n  });\n}\n\nconst shortcutRelationships = {\n  'left': moveInDirection.bind(null, 'left'),\n  'up': moveInDirection.bind(null, 'up'),\n  'down': moveInDirection.bind(null, 'down'),\n  'right': moveInDirection.bind(null, 'right'),\n\n  'h': moveInDirection.bind(null, 'left'),\n  'k': moveInDirection.bind(null, 'up'),\n  'j': moveInDirection.bind(null, 'down'),\n  'l': moveInDirection.bind(null, 'right'),\n\n  'u': moveToParent,\n  'i': moveToParent,\n  'shift-enter': moveToParent,\n  'space': moveToParent,\n\n  'n': moveToChild,\n  'm': moveToChild,\n\n  'escape': removeSelection,\n  'z': zoomOnLocalPath,\n  'd': duplicate,\n  'shift-up': topicParentLink,\n  'shift-k': topicParentLink,\n\n  'c': copyDecodedUrl,\n\n  'enter': () => moveDownOrRedirect({}),\n  'meta-enter': () => moveDownOrRedirect({ newTab: true }), // mac\n  'ctrl-enter': () => moveDownOrRedirect({ newTab: true }), // windows & linux\n  'alt-enter': () => moveDownOrRedirect({ newTab: false, altKey: true }),\n  'meta-alt-enter': () => moveDownOrRedirect({ newTab: true, altKey: true }), // mac\n  'ctrl-alt-enter': () => moveDownOrRedirect({ newTab: true, altKey: true }), // windows & linux\n\n  'tab': depthFirstSearch,\n  'shift-tab': browserBack\n}\n\nconst keyNames = {\n  37: 'left',\n  39: 'right',\n  38: 'up',\n  40: 'down',\n\n  71: 'g',\n  72: 'h',\n  75: 'k',\n  74: 'j',\n  76: 'l',\n  186: ';',\n  90: 'z',\n  68: 'd',\n  67: 'c',\n\n  85: 'u',\n  73: 'i',\n  78: 'n',\n  77: 'm',\n\n  13: 'enter',\n  9: 'tab',\n  27: 'escape',\n  32: 'space',\n\n  192: '`',\n\n  49: '1',\n  50: '2',\n  51: '3',\n  52: '4',\n  53: '5',\n}\n\nexport default registerKeyListeners;\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\nimport Paragraph from 'models/paragraph';\n\nfunction registerPopStateListener() {\n  if ('scrollRestoration' in history) {\n    history.scrollRestoration = 'manual';\n  }\n\n  window.addEventListener('popstate', (e) => {\n    let linkSelection = Link.selectionPresentInEvent(e) ? new Link(e.state) : null;\n\n    let scrollStyle;\n    if (Paragraph.current.path.rootTopicPath.equals(Path.current.rootTopicPath)) { // Navigating within the same page\n      scrollStyle = 'smooth';\n    } else { // Nagivating to a new page\n      scrollStyle = 'auto';\n    }\n\n    updateView(\n      Path.currentOrDefault,\n      linkSelection || Link.sessionSelection,\n      { scrollStyle }\n    );\n  });\n}\n\nexport default registerPopStateListener;\n","import 'style/canopy.scss';\nimport updateView from 'display/update_view';\nimport registerKeyListeners from 'keys/register_key_listeners';\nimport registerPopStateListener from 'history/register_pop_state_listener';\nimport Path from 'models/path';\nimport Link from 'models/link';\n\nregisterKeyListeners();\nregisterPopStateListener();\n\nupdateView(\n  Path.currentOrDefault,\n  Link.priorSelection,\n  { scrollStyle: 'auto' }\n);\n"],"names":["module","exports","removeStyleCharacters","string","newString","replace","require","Topic","_classCallCheck","this","display","mixedCase","split","map","join","escapedMixedCase","CSS","escape","slug","url","fileName","caps","toUpperCase","trim","requestFileName","encodeURIComponent","key","value","topic","convertUnderscoresToSpaces","decodeURIComponent","convertSpacesToUnderscores","___CSS_LOADER_EXPORT___","push","id","cssWithMappingToString","list","toString","item","content","needLayer","concat","length","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","root","g","cssEscape","arguments","TypeError","codeUnit","String","index","result","firstCodeUnit","charCodeAt","charAt","factory","stylesInDOM","getIndexByIdentifier","identifier","modulesToDom","options","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","newLastIdentifiers","_i","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","get","globalThis","Function","prop","prototype","hasOwnProperty","nc","canopyContainer","getElementById","dataset","canopyVersion","defaultTopic","projectPathPrefix","hashUrls","getAncestorElement","currentElement","className","parentElement","classList","contains","Link","argument","tagName","_typeof","metadataObject","selectorCallback","linkElement","link","pathString","Paragraph","path","text","relativeLinkNumber","object","paragraph","Path","linkBySelector","linkToSelect","_document$querySelect","persistInHistory","persistInSession","persistLastSelectionData","add","state","containsLinkSelectionMetadata","sessionData","sessionStorage","getItem","parse","history","historySelection","sessionSelection","selectedLink","linkData","metadata","setItem","location","pathname","hash","replaceState","title","href","firstLink","parentLink","lastSelectionsOfParagraph","enclosingParagraph","_unused","otherLink","targetTopic","targetSubtopic","elementFromMetadata","set","HTMLAnchorElement","transferDataset","_targetTopic","_targetSubtopic","_enclosingTopic","enclosingTopic","_enclosingSubtopic","enclosingSubtopic","_typeValue","type","enclosingSectionElement","isParent","pathDepth","isGlobalOrImport","Number","sectionElement","newPath","_this","parentParagraph","links","find","matcher","pathArray","slice","lastSegment","_this2","matches","storedRelativeLinkNumber","indexOf","collectMetadata","addSegment","isLocal","replaceTerminalSubtopic","equals","linkElements","siblings","targetParagraph","lastLink","_this$parentLink","includes","isOpen","isGlobal","isImport","hasLinks","otherParagraph","opacity","_topicName","topicName","_subtopicName","subtopicName","paragraphElement","Array","from","childNodes","currentParagraph","currentTopicParagraph","topicParagraph","unshift","linkObjects","querySelectorAll","subtopic","callback","filter","linkByTarget","linksBySelector","pageRoot","displayTopicName","isTopic","isArray","validatePathArray","arrayToString","stringToArray","otherPath","forEach","_this$pathArray$slice","empty","newSubtopic","withoutLastSegment","firstTopic","_this$lastSegment$pat","elementAtRelativePath","array","tuple","newError","origin","current","slashSeparatedUnits","fixOrphanSubtopics","slashSeparatedUnit","match","segment","_ref","_ref2","_slicedToArray","topicString","subtopicString","_ref3","_ref4","pathSegmentString","newItem","pathToDisplay","console","error","rootElement","currentNode","subpath","currentPathDepth","firstSubtopic","withoutFirstSegment","oldPath","documentTitle","historyApiFunction","b","c","pushState","fullPathString","REQUEST_CACHE","dataPath","promise","fetch","then","res","json","parsedJson","imagePreloadArray","matchAll","m","image","Image","src","preloadImages","Promise","reject","onGlobalAndImportLinkClick","preventDefault","newTab","metaKey","ctrlKey","altKey","isSelected","updateView","scrollStyle","scrollTo","open","displayPathTo","visibleParagraphs","displayOptions","allocateSpace","isPageRoot","parentLinks","ancestorImportReferences","_linkToSelect2","_linkToSelect3","log","displayPath","defaultRedirect","tryPathPrefix","_linkToSelect","contradicts","resetDom","header","headerDomElement","show","setHeader","rootTopicPath","select","scrollPage","setTimeout","getElementsByTagName","behavior","imageLoadScrollBehavior","top","maxScrollRatio","Infinity","scrollElementToPosition","targetRatio","minDiff","side","pointToPutAtTarget","direction","rect","getBoundingClientRect","viewportHeight","innerHeight","currentScroll","pageYOffset","idealTargetPosition","bottom","actualScrollY","idealScrollY","maxScrollDistance","Math","min","max","shouldScroll","abs","renderTokenElement","token","renderContext","spanElement","innerText","renderTextToken","localLinkSubtreeCallback","tokens","subtoken","subtokenElement","_link$parentLink","targetPath","atNewPath","addEventListener","_CanopyClickHandler","createLocalLinkElement","renderLocalLink","globalLinkSubtreeCallback","createGlobalLinkElement","renderGlobalLink","createImportLinkElement","renderImportLink","tokensContainer","innerHTML","svgContainer","externalLinkIconSvg","renderLinkLiteral","divElement","imageElement","resourceUrl","anchorElement","anchorUrl","caption","altText","setProperty","isVisible","renderImage","fragment","createRange","createContextualFragment","html","height","width","originalOpacity","renderHtmlElement","superscriptElement","textNode","renderFootnoteSymbol","preElement","codeBlockElement","renderCodeBlock","blockQuoteElement","renderBlockQuote","renderList","topLevelNodes","tableElement","rtl","rows","row","tableRowElement","cellObject","tableCellElement","hidden","tokenElement","colspan","rowspan","removeEventListener","merge","renderTable","containerElement","tableListElement","dir","tableCellSize","SizesByWidth","SizesByArea","minimumCellArea","minimumCellWidth","items","rowSize","cellElements","contentContainer","ordinalElement","ordinal","prepend","longestWordLength","sort","totalLength","newSize","setInterval","elements","largestHeight","computedHeight","getComputedStyle","parseFloat","getLargestHeight","clearInterval","createNewRow","newRow","renderTableList","footnoteLinesToken","div","horizonalRule","lines","line","footnoteSpan","superscript","renderFootnoteLines","renderBoldText","renderStrikethroughText","renderItalicText","renderInlineCodeText","visibility","listNodeObjects","listElement","ordered","listNodeObject","listItemElement","tokensOfLine","children","childList","renderDomTree","paragraphsBySubtopic","createSectionElement","displayBlockingPromises","promisedSubtree","assign","subtree","requestJson","currentlyRenderingSubtopic","subtopicOfPathContainingOpenGlobalReference","openGlobalLinkExists","secondTopic","openGlobalLinkTargetTopic","openGlobalLinkTargetSubtopic","thisGlobalLinkIsPointingToTheRightThingToBeOpen","thisGlobalLinkIsInCorrectSubtopicToBeOpen","globalLinkIsOpen","whenTopicTreeAppended","fetchAndRenderPath","tokensOfParagraph","all","resolve","preexistingElement","firstSegment","topicTokens","headerElement","generateHeader","_ref5","validatePathAndLink","moveToParent","topicParentLink","newLink","moveToChild","oldLink","_oldLink$targetParagr","_oldLink$targetParagr2","moveDownOrRedirect","_Link$selection$targe","_Link$selection$targe2","_Link$selection$targe3","_Link$selection$targe4","windowHeight","windowWidth","innerWidth","visibleWidth","right","left","moveInDirection","currentLinkElement","candidateLinks","offsetParent","currentSelectionHigherRect","getBoundingRectInDirection","currentSelectionLowerRect","candidateRectContainers","getRectsOfElements","rectObject","isHigher","isVerticallyOverlapping","scrollOrSelect","reduce","lowestHigherRect","newRect","_Link$selection$paren","_Link$selection$paren2","closest","isLower","isHorizontallyWithin","isHorizontallyOverlapping","greaterHorizontalOverlap","horizontallyCloserRect","highestLowerRect","currentSelectionRect","rectContainers","rightmostLeftRect","distanceComparingSide","verticalDirectionOfWrap","getTextDirectionOfRootAncestor","horizontalDirectionOfWrap","horizontalDirectionToWrapAfterLink","isInCorrectVerticalDirection","isInBetterVerticalDirection","closerToCorrectHorizontalEdge","rightMostRect","leftMostRect","rightmostUpwardRect","verticalDirectionOfExtremeWrap","horizontalDirectionOfExtremeWrap","horizontalDirectionToWrapAfterExtremeLink","isVerticallyFarther","closerToCorrectExtremeHorizontalEdge","rightBottomMostRect","leftmostRightRect","rect2","rect1","verticalDirectionToWrapAfterRightmostLink","leftmostDownwardRect","verticalDirectionToWrapAfterFinalRightmostLink","verticalSideToCompareExtremeWrap","closerToCorrectHorizontalExtremeEdge","leftmostTopRect","targetRect","midpointRect1","midpointRect2","midpointTarget","selectedRect","candidateRect1","candidateRect2","calculateHorizontalOverlap","_defineProperty","elementArray","_step","_iterator","_createForOfIteratorHelper","s","done","elementForRect","subRects","getClientRects","singleRect","_objectSpread","commonAncestorIsContainer","x","y","err","f","ancestor1","ancestor2","tempAncestor2","multipleRects","rectangles","mergedRectangles","currentRect","nextRect","mergeRectsWithSameTop","textNodesRects","traverse","node","nodeType","Node","TEXT_NODE","range","selectNodeContents","rects","ELEMENT_NODE","_step2","_iterator2","getTextNodesRects","leftmostRect","rightmostRect","uppermostRect","lowestRect","getPreviousLinkOfParagraph","getNextLinkOfParagraph","allLinks","currentLinkIndex","getHighestAncestor","RegExp","test","shortcutRelationships","bind","currentLink","localPathSegmentWhenSelected","navigator","clipboard","writeText","hasChildren","nextLink","firstChildLink","nextSibling","_link$parentLink2","lastSibling","parentSibling","firstSibling","oldPathname","back","forward","keyNames","activeElement","modifiers","shiftKey","keyName","keyCode","shortcutName","scrollRestoration","linkSelection"],"sourceRoot":""}